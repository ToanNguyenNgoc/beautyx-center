"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[513,700],{93104:(e,i,l)=>{l.d(i,{w:()=>m});var s=l(65043),a=(l(9951),l(43845)),r=l(81045),n=l(81637),d=l(93911),t=l(53536),o=l(42807),c=l(70579);const m=e=>{var i,l;let{orgsChoose:m=[],values:u=[],setValues:v,onChangeService:h}=e;const g=(0,s.useRef)(null),x=u.map((e=>e.id)),[p,j]=(0,s.useState)({data:[],load:!1}),b=e=>{var i,l,s,a;if(m.length>0&&"show"===e)return null===(s=g.current)||void 0===s||null===(a=s.classList)||void 0===a?void 0:a.add("box-services-show");if("hide"===e)return null===(i=g.current)||void 0===i||null===(l=i.classList)||void 0===l?void 0:l.remove("box-services-show")};window.addEventListener("click",(()=>b("hide")));const f=(0,s.useCallback)((0,t.debounce)(((e,i)=>{j({data:[],load:!0}),(async(e,i)=>{let l=[];for(var s of i){var a;const i=await d.A.getServicesByOrg({keyword:e,org_id:null===(a=s)||void 0===a?void 0:a.id}),r={services:null===i||void 0===i?void 0:i.data.context.data,org:s};l.push(r)}j({data:l,load:!1})})(e,i)}),1500),[]),N=null!==(i=null===(l=p.data)||void 0===l?void 0:l.map((e=>e.services)).flat())&&void 0!==i?i:[],y=e=>{if(h){const i=u.findIndex((i=>i.id===e.id));h(i<0?[...u,e]:u.filter((i=>i.id!==e.id)))}else v&&v((i=>i.findIndex((i=>i.id===e.id))<0?i=[...i,e]:i.filter((i=>i.id!==e.id))))};return(0,c.jsxs)("div",{className:"select-services",children:[(0,c.jsx)("label",{className:"required form-label",children:"S\u1ea3n ph\u1ea9m \xe1p d\u1ee5ng"}),(0,c.jsx)("div",{onClick:e=>{e.stopPropagation(),b("show")},className:"form-control form-control-solid ser-selected",children:u.map((e=>(0,c.jsx)(a.A,{label:`${e.service_name} | Gi\xe1 g\u1ed1c: ${(0,o.$g)(e.price)}`,onDelete:()=>y(e),size:"medium",color:"primary",avatar:(0,c.jsx)(r.A,{src:e.image_url})},e.id)))}),(0,c.jsxs)("div",{onClick:e=>e.stopPropagation(),ref:g,className:"box-services",children:[(0,c.jsxs)("div",{className:"box-service-input",children:[p.load&&(0,c.jsx)(n.A,{size:16}),(0,c.jsx)("input",{onChange:e=>{m&&m.length>0&&f(e.target.value,m)},type:"text",className:"form-control form-control-solid",placeholder:"T\xecm ki\u1ebfm d\u1ecbch v\u1ee5..."})]}),(0,c.jsx)("div",{className:"services-list",children:(0,c.jsx)("ul",{children:N.filter(Boolean).map(((e,i)=>(0,c.jsx)("li",{children:(0,c.jsxs)("div",{style:x.includes(e.id)?{backgroundColor:"var(--kt-gray-200)"}:{},onClick:()=>y(e),className:"service-item",children:[(0,c.jsx)("div",{className:"image",children:(0,c.jsx)("img",{src:e.image_url,onError:e=>(0,o.pG)(e),alt:""})}),(0,c.jsxs)("div",{className:"service-detail",children:[(0,c.jsx)("p",{className:"service-name",children:e.service_name}),(0,c.jsx)("p",{className:"service-price",children:(0,o.$g)(e.price)})]})]})},i)))})})]})]})}},98513:(e,i,l)=>{l.r(i),l.d(i,{default:()=>p});var s=l(93511),a=l(63516),r=l(65043),n=l(86971),d=l(82025),t=l(42807),o=l(56850),c=l(81637),m=l(82907),u=l(6940),v=l(72812),h=l(55854),g=l(93104),x=l(70579);const p=function(){var e;const i=(0,n.g)(),{resultLoad:l,noti:p,onCloseNoti:j}=(0,d.JX)(),{handlePostMedia:b}=(0,d._r)(),[f,N]=(0,r.useState)(),[y,_]=(0,r.useState)([]),{handlePostMedia:C,isLoading:k}=(0,d._r)(),{mutate:w,isLoading:F}=(0,m.useMutation)({mutationFn:e=>i.id?u.Z7.putTrend(i.id,e):u.Z7.postTrend(e),onSuccess:()=>i.id?l({message:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"}):l({message:"T\u1ea1o m\u1edbi th\xe0nh c\xf4ng"}),onError:e=>{var i;l({color:"error",message:`C\xf3 l\u1ed7i x\u1ea3y ra. M\xe3 l\u1ed7i ${null===e||void 0===e||null===(i=e.request)||void 0===i?void 0:i.status}`})}}),S=(0,a.Wx)({initialValues:{media_url:"",image_thumb:"",title:"",content:"",trend_url:""},onSubmit:e=>{w({...e,organization_id:null===f||void 0===f?void 0:f.id,services:y.map((e=>e.id))})}}),{refetch:V,isRefetching:T,data:q}=(0,m.useQuery)({queryKey:["TREND",i.id],queryFn:()=>u.Z7.trend(i.id),enabled:!!i.id,onSuccess:e=>{const i=e.context,l=i.services;_(l),S.setFieldValue("media_url",i.media_url),S.setFieldValue("image_thumb",i.image_thumb),S.setFieldValue("title",i.title),S.setFieldValue("content",i.content),S.setFieldValue("trend_url",i.trend_url)}});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(h.ce,{severity:p.color,message:p.message,open:p.openAlert,close:j}),(0,x.jsx)(s.A,{title:i.id?"Thay \u0111\u1ed5i n\u1ed9i dung":"Th\xeam m\u1edbi"}),(0,x.jsx)("div",{className:"container",children:(0,x.jsxs)("form",{onSubmit:S.handleSubmit,className:"trend-form",children:[(0,x.jsxs)("div",{className:"video d-flex justify-content-between",children:[(0,x.jsxs)("div",{className:"video-left",children:[(0,x.jsx)("div",{className:"required form-label",children:"Video"}),(0,x.jsxs)("div",{className:"drag-video",children:[k&&(0,x.jsxs)("div",{className:"drag-video-load",children:["\u0110ang t\u1ea3i video l\xean...",(0,x.jsx)(c.A,{})]}),""===S.values.media_url?(0,x.jsx)("img",{src:o.X.imgPlaceHolder,alt:""}):(0,x.jsx)("video",{controls:!0,children:(0,x.jsx)("source",{src:S.values.media_url})})]}),(0,x.jsxs)("div",{className:"input-video",children:[(0,x.jsx)("input",{onChange:e=>{C({e:e,callBack:e=>{var i;return S.setFieldValue("media_url",null===(i=e[0])||void 0===i?void 0:i.original_url)},version:"api.beautyx",resetOriginalResult:!0})},hidden:!0,type:"file",accept:t.vj,id:"video"}),(0,x.jsx)("label",{htmlFor:"video",className:"btn btn-primary btn-up-img",children:(0,x.jsx)("i",{className:"bi bi-arrow-bar-up"})}),(0,x.jsx)("input",{onChange:S.handleChange,name:"media_url",value:S.values.media_url,type:"text",className:"form-control form-control-solid mt-4",placeholder:"Ho\u1eb7c video url..."})]})]}),(0,x.jsxs)("div",{className:"video-right",children:[(0,x.jsx)("div",{className:"required form-label",children:"Image thumbnail"}),(0,x.jsx)("div",{className:"drag-image",children:(0,x.jsx)("img",{src:S.values.image_thumb||o.X.imgPlaceHolder,alt:""})}),(0,x.jsxs)("div",{className:"input-img",children:[(0,x.jsx)("input",{onChange:e=>{b({e:e,callBack:e=>{var i;return S.setFieldValue("image_thumb",null===(i=e[0])||void 0===i?void 0:i.original_url)},version:"api.beautyx",resetOriginalResult:!0})},hidden:!0,type:"file",accept:t.HU,id:"up-img"}),(0,x.jsx)("label",{htmlFor:"up-img",className:"btn btn-primary btn-up-img",children:(0,x.jsx)("i",{className:"bi bi-arrow-bar-up"})}),(0,x.jsx)("input",{onChange:S.handleChange,value:S.values.image_thumb,name:"image_thumb",type:"text",className:"form-control form-control-solid mt-4",placeholder:"Ho\u1eb7c image url..."})]})]})]}),(0,x.jsxs)("div",{className:"col mt-4",children:[(0,x.jsx)("div",{className:"required form-label",children:"Ti\xeau \u0111\u1ec1"}),(0,x.jsx)("input",{type:"text",onChange:S.handleChange,value:S.values.title,name:"title",className:"form-control form-control-solid",placeholder:"Ti\xeau \u0111\u1ec1"})]}),(0,x.jsxs)("div",{className:"col mt-4",children:[(0,x.jsx)("div",{className:"required form-label",children:"N\u1ed9i dung"}),(0,x.jsx)("input",{type:"text",onChange:S.handleChange,value:S.values.content,name:"content",className:"form-control form-control-solid",placeholder:"N\u1ed9i dung"})]}),(0,x.jsxs)("div",{className:"col mt-4",children:[(0,x.jsx)("div",{className:"required form-label",children:"Link tiktok"}),(0,x.jsx)("input",{type:"text",onChange:S.handleChange,value:S.values.trend_url,name:"trend_url",className:"form-control form-control-solid",placeholder:"Link tiktok"})]}),(0,x.jsxs)("div",{className:"mt-4",children:[(0,x.jsx)(h.$P,{organization_id:null===q||void 0===q||null===(e=q.context)||void 0===e?void 0:e.organization_id,origin:f,setOrigin:N}),(0,x.jsx)("div",{className:"mt-4",children:(0,x.jsx)(g.w,{orgsChoose:f?[f]:[],values:y,setValues:_})})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-end mt-8",children:[i.id&&(0,x.jsx)(v.A,{style:{marginRight:"8px"},onClick:()=>V(),loading:T,type:"button",variant:"contained",color:"primary",size:"large",children:"Kh\xf4i ph\u1ee5c"}),(0,x.jsx)(v.A,{loading:F,type:"submit",variant:"contained",color:"success",size:"large",children:i.id?"L\u01b0u thay \u0111\u1ed5i":"T\u1ea1o m\u1edbi"})]})]})})]})}},9951:()=>{}}]);
//# sourceMappingURL=513.1ec04b2d.chunk.js.map