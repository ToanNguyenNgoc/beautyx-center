"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[594],{23594:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(42982),s=a(70885),l=a(1413),r=a(93044),i=a(66362),o=a(17964),c=a(39891),d=a(72930),m=a(77356),h=a(35036),f=a(52902),u=a(66305),x=a(11838),g=a(91933),p=a(43504),v=a(16871),j=a(4245),b=a(72791),N=a(763),w=a(72426),y=a.n(w),_=a(39709),k=a(64802),Z=a(34045),D=a(65298),S=a(80184);var C=function(){var e,t,a=(0,v.TH)(),n=(0,v.s0)(),s=j.parse(a.search),i=(0,g.useQuery)({queryKey:[f.xG.CUSTOMER,s],queryFn:function(){return m.Dd.customers({page:s.page,limit:15,platform:s.platform,sort:s.sort||"-created_at",from_date:s.from_date,to_date:s.to_date})},staleTime:f.I3}),o=i.data,c=i.isLoading,b=(null===o||void 0===o?void 0:o.data)||[];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.Z,{title:"Danh s\xe1ch kh\xe1ch h\xe0ng"}),(0,S.jsxs)("div",{className:"card",children:[(0,S.jsx)("div",{className:"card-header border-0 pt-5",children:(0,S.jsxs)("h3",{className:"card-title align-items-start flex-column",children:[(0,S.jsx)("span",{className:"card-label fw-bold fs-3 mb-1",children:"Customer Statistics"}),(0,S.jsxs)("span",{className:"text-muted mt-1 fw-semobold fs-7",children:["S\u1ed1 l\u01b0\u1ee3ng:",null===o||void 0===o?void 0:o.total," members"]})]})}),(0,S.jsx)(T,{query:s}),(0,S.jsx)("div",{className:"d-flex justify-content-end px-12",children:o&&(0,S.jsx)(H,{data:o,qr:s})}),(0,S.jsx)("div",{className:"card-body py-3",children:(0,S.jsxs)("div",{className:"table-responsive",children:[(0,S.jsxs)("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{className:"fw-bold text-muted",children:[(0,S.jsx)("th",{className:"min-w-150px",children:"Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,S.jsx)("th",{className:"min-w-140px",children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"}),(0,S.jsx)("th",{className:"min-w-140px",children:"N\u1ec1n t\u1ea3ng"}),(0,S.jsx)("th",{className:"min-w-120px",children:"Ng\xe0y \u0111\u0103ng k\xfd"}),(0,S.jsx)("th",{className:"min-w-100px text-end",children:"Actions"})]})}),(0,S.jsx)("tbody",{children:b.map((function(e){return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{children:(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:"symbol symbol-45px me-5",children:(0,S.jsx)(r.Z,{src:e.avatar||e.fullname,alt:e.fullname})}),(0,S.jsxs)("div",{className:"d-flex justify-content-start flex-column",children:[(0,S.jsx)("span",{className:"text-dark fw-bold fs-6",children:e.fullname}),(0,S.jsx)("span",{className:"fw-semobold text-muted d-block fs-7",children:e.email})]})]})}),(0,S.jsx)("td",{children:(0,S.jsx)("a",{href:"tel:".concat(e.telephone),className:"text-dark fw-bold text-hover-primary d-block fs-6",children:e.telephone})}),(0,S.jsx)("td",{children:(0,S.jsx)(u.fW,{platForm:e.platform})}),(0,S.jsx)("td",{children:(0,S.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:(0,h.p6)(e.created_at)})}),(0,S.jsx)("td",{children:(0,S.jsx)("div",{className:"d-flex justify-content-end flex-shrink-0",children:(0,S.jsx)(p.rU,{to:"#",className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",children:(0,S.jsx)(d.D8,{path:"/media/icons/duotune/general/gen019.svg",className:"svg-icon-3"})})})})]},e.id)}))})]}),(0,S.jsx)(u.Am,{loading:c}),(0,S.jsx)(u.Aw,{totalPage:null!==(e=null===o||void 0===o?void 0:o.last_page)&&void 0!==e?e:1,onChangePage:function(e){var t=(0,l.Z)((0,l.Z)({},s),{},{page:e});n({pathname:a.pathname,search:j.stringify(t)})},defaultPage:null!==(t=s.page)&&void 0!==t?t:1})]})})]})]})},T=function(e){var t,a,n=e.query,r=(0,v.TH)(),d=(0,v.s0)(),m=[{sort:"-created_at",title:"Ng\xe0y \u0111\u0103ng k\xfd m\u1edbi"},{sort:"created_at",title:"Ng\xe0y \u0111\u0103ng k\xfd c\u0169"}],f=(0,b.useState)({form:n.from_date,to:n.to_date}),x=(0,s.Z)(f,2),g=x[0],p=x[1];return(0,S.jsxs)("div",{className:"d-flex justify-content-between filter-cnt",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"filter-row_label",children:"T\xecm ki\u1ebfm"}),(0,S.jsx)("input",{className:"form-control form-control-solid py-2 px-6",placeholder:"T\xecm ki\u1ebfm"})]}),(0,S.jsxs)("div",{className:"filter-right",children:[(0,S.jsxs)("div",{className:"filter-row",children:[(0,S.jsxs)("div",{className:"filter-row_platform",children:[(0,S.jsx)("label",{className:"filter-row_label",children:"N\u1ec1n t\u1ea3ng"}),(0,S.jsx)(i.Z,{sx:{m:1,minWidth:150},size:"small",children:(0,S.jsxs)(o.Z,{labelId:"demo-select-small-label",id:"demo-select-small",value:null!==(t=n.platform)&&void 0!==t?t:"",onChange:function(e){var t=(0,l.Z)((0,l.Z)({},n),{},{page:1,platform:""!==e.target.value?e.target.value:""});d({pathname:r.pathname,search:j.stringify((0,N.pickBy)(t,N.identity))})},children:[(0,S.jsx)(c.Z,{value:"",children:(0,S.jsx)("em",{children:"T\u1ea5t c\u1ea3"})}),h.eN.map((function(e){return(0,S.jsx)(c.Z,{value:e,children:e},e)}))]})})]}),(0,S.jsxs)("div",{className:"filter-row_platform",children:[(0,S.jsx)("label",{className:"filter-row_label",children:"S\u1eafp x\u1ebfp theo"}),(0,S.jsx)(i.Z,{sx:{m:1,minWidth:150},size:"small",children:(0,S.jsx)(o.Z,{labelId:"demo-select-small-label",id:"demo-select-small",value:null!==(a=n.sort)&&void 0!==a?a:m[0].sort,onChange:function(e){var t=(0,l.Z)((0,l.Z)({},n),{},{sort:e.target.value,page:1});d({pathname:r.pathname,search:j.stringify(t)})},children:m.map((function(e){return(0,S.jsx)(c.Z,{value:e.sort,children:e.title},e.sort)}))})})]})]}),(0,S.jsx)("div",{className:"filter-row_picker",children:(0,S.jsx)(u.YS,{showBot:!0,init:!g.form||!g.to,startDate:g.form?new Date(g.form):new Date,endDate:g.to?new Date(g.to):new Date,label:"Th\u1eddi gian \u0111\u0103ng k\xfd",onChange:function(e){return p({form:y()(e.selection.startDate).format("YYYY-MM-DD HH:mm:ss"),to:y()(e.selection.endDate).format("YYYY-MM-DD HH:mm:ss")})},onApply:function(){var e=(0,l.Z)((0,l.Z)({},n),{},{page:1,from_date:g.form,to_date:g.to});d({pathname:r.pathname,search:j.stringify(e)})},onCancel:function(){var e=(0,l.Z)((0,l.Z)({},n),{},{page:1,from_date:void 0,to_date:void 0});p({form:void 0,to:void 0}),d({pathname:r.pathname,search:j.stringify((0,N.pickBy)(e,N.identity))})}})})]})]})},H=function(e){var t=e.data,a=e.qr,r=(0,b.useState)([]),i=(0,s.Z)(r,2),o=i[0],c=i[1],d=(0,D.UD)(),f=d.resultLoad,x=d.noti,p=d.onCloseNoti,v=(0,b.useState)(!1),j=(0,s.Z)(v,2),N=j[0],w=j[1],y=(0,g.useMutation)({mutationFn:function(e){return m.Dd.customers((0,l.Z)((0,l.Z)({},a),{},{page:e,limit:15}))},onSuccess:function(e){return c((function(t){return[].concat((0,n.Z)(t),(0,n.Z)(e.data))}))}}),k=y.mutate,Z=y.isLoading;return(0,b.useEffect)((function(){N&&o.length>0&&o.length===(null===t||void 0===t?void 0:t.total)&&Y(o).then((function(){f({message:"Xu\u1ea5t File th\xe0nh c\xf4ng",color:"success"}),c([]),w(!1)})),o.length===(null===t||void 0===t?void 0:t.total)&&c([])}),[o,null===t||void 0===t?void 0:t.total]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(u.Ct,{severity:x.color,message:x.message,open:x.openAlert,close:p}),(0,S.jsxs)(_.Z,{color:"success",size:"medium",variant:"contained",onClick:function(){if(0!==t.data.length){if(!a.from_date||!a.to_date)return f({message:"Vui l\xf2ng ch\u1ecdn kho\u1ea3ng th\u1eddi gian",color:"warning"});if((0,h.$h)(a.from_date?new Date(a.from_date):new Date,a.to_date?new Date(a.to_date):new Date).length>31)return f({message:"Xu\u1ea5t danh s\xe1ch t\u1ed1i \u0111a trong 30 ng\xe0y",color:"warning"});w(!0);for(var e=1;e<=(null===t||void 0===t?void 0:t.last_page);e++)k(e)}},type:"button",loading:Z,children:[(0,S.jsx)("i",{style:{marginRight:"4px",color:"var(--kt-white)"},className:"bi bi-download"}),"Xu\u1ea5t danh s\xe1ch"]})]})},Y=function(e){return new Promise((function(t,a){var s=[["#","ID","H\u1ecd v\xe0 t\xean","Email","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i","N\u1ec1n t\u1ea3ng","Ng\xe0y \u0111\u0103ng k\xfd"]].concat((0,n.Z)(e.map((function(e,t){return[t+1,e.id,e.fullname,e.email,e.telephone,e.platform,e.created_at]})))),l=Z.P6.aoa_to_sheet(s);l["!cols"]=[{wch:5},{wch:10},{wch:35},{wch:25},{wch:25},{wch:25},{wch:25}];var r={Sheets:{data:l},SheetNames:["data"]},i=Z.cW(r,{bookType:"xlsx",type:"array"}),o=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});k.saveAs(o,"ds_khach_hang_".concat(y()().format("DDHHmmss"))+".xlsx"),t(!0)}))}},11838:function(e,t,a){a.d(t,{Z:function(){return s}});a(72791);var n=a(80184);var s=function(e){var t=e.title,a=e.element;return(0,n.jsx)("div",{className:"toolbar",id:"kt_toolbar",children:(0,n.jsxs)("div",{id:"kt_toolbar_container",className:"container-fluid d-flex flex-stack",children:[(0,n.jsx)("h1",{className:"d-flex align-items-center text-dark fw-bolder my-1 fs-3",children:t}),a]})})}}}]);
//# sourceMappingURL=594.f2b65bb2.chunk.js.map