"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[374],{16374:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var s=a(81045),l=a(87561),n=a(83521),i=a(88988),r=a(85450),o=a(73589),d=a(42807),c=a(6171),m=a(95434),h=a(93511),x=a(82907),f=a(86971),g=a(51318),p=a(9370),u=a(65043),j=a(53536),v=a(86178),b=a.n(v),N=a(72812),w=a(72450),y=a(11238),_=a(3717),k=a(70579);const D=function(){var e,t;const a=(0,f.zy)(),l=(0,f.Zp)(),n=p.parse(a.search),{data:i,isLoading:u}=(0,x.useQuery)({queryKey:[c.Eo.CUSTOMER,n],queryFn:()=>o.$C.customers({page:n.page,limit:15,platform:n.platform,sort:n.sort||"-created_at",from_date:n.from_date,to_date:n.to_date}),staleTime:c.NJ}),j=(null===i||void 0===i?void 0:i.data)||[];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(h.A,{title:"Danh s\xe1ch kh\xe1ch h\xe0ng"}),(0,k.jsxs)("div",{className:"card",children:[(0,k.jsx)("div",{className:"card-header border-0 pt-5",children:(0,k.jsxs)("h3",{className:"card-title align-items-start flex-column",children:[(0,k.jsx)("span",{className:"card-label fw-bold fs-3 mb-1",children:"Customer Statistics"}),(0,k.jsxs)("span",{className:"text-muted mt-1 fw-semobold fs-7",children:["S\u1ed1 l\u01b0\u1ee3ng:",null===i||void 0===i?void 0:i.total," members"]})]})}),(0,k.jsx)(A,{query:n}),(0,k.jsx)("div",{className:"d-flex justify-content-end px-12",children:i&&(0,k.jsx)(C,{data:i,qr:n})}),(0,k.jsx)("div",{className:"card-body py-3",children:(0,k.jsxs)("div",{className:"table-responsive",children:[(0,k.jsxs)("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"fw-bold text-muted",children:[(0,k.jsx)("th",{className:"min-w-150px",children:"Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,k.jsx)("th",{className:"min-w-140px",children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"}),(0,k.jsx)("th",{className:"min-w-140px",children:"N\u1ec1n t\u1ea3ng"}),(0,k.jsx)("th",{className:"min-w-120px",children:"Ng\xe0y \u0111\u0103ng k\xfd"}),(0,k.jsx)("th",{className:"min-w-100px text-end",children:"Actions"})]})}),(0,k.jsx)("tbody",{children:j.map((e=>(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{children:(0,k.jsxs)("div",{className:"d-flex align-items-center",children:[(0,k.jsx)("div",{className:"symbol symbol-45px me-5",children:(0,k.jsx)(s.A,{src:e.avatar||e.fullname,alt:e.fullname})}),(0,k.jsxs)("div",{className:"d-flex justify-content-start flex-column",children:[(0,k.jsx)("span",{className:"text-dark fw-bold fs-6",children:e.fullname}),(0,k.jsx)("span",{className:"fw-semobold text-muted d-block fs-7",children:e.email})]})]})}),(0,k.jsx)("td",{children:(0,k.jsx)("a",{href:`tel:${e.telephone}`,className:"text-dark fw-bold text-hover-primary d-block fs-6",children:e.telephone})}),(0,k.jsx)("td",{children:(0,k.jsx)(m._8,{platForm:e.platform})}),(0,k.jsx)("td",{children:(0,k.jsx)("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:(0,d.Yq)(e.created_at)})}),(0,k.jsx)("td",{children:(0,k.jsx)("div",{className:"d-flex justify-content-end flex-shrink-0",children:(0,k.jsx)(g.N_,{to:"#",className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",children:(0,k.jsx)(r.aO,{path:"/media/icons/duotune/general/gen019.svg",className:"svg-icon-3"})})})})]},e.id)))})]}),(0,k.jsx)(m.kJ,{loading:u}),(0,k.jsx)(m.f_,{totalPage:null!==(e=null===i||void 0===i?void 0:i.last_page)&&void 0!==e?e:1,onChangePage:e=>{const t={...n,page:e};l({pathname:a.pathname,search:p.stringify(t)})},defaultPage:null!==(t=n.page)&&void 0!==t?t:1})]})})]})]})},A=e=>{var t,a;let{query:s}=e;const r=(0,f.zy)(),o=(0,f.Zp)(),c=[{sort:"-created_at",title:"Ng\xe0y \u0111\u0103ng k\xfd m\u1edbi"},{sort:"created_at",title:"Ng\xe0y \u0111\u0103ng k\xfd c\u0169"}],[h,x]=(0,u.useState)({form:s.from_date,to:s.to_date});return(0,k.jsxs)("div",{className:"d-flex justify-content-between filter-cnt",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"filter-row_label",children:"T\xecm ki\u1ebfm"}),(0,k.jsx)("input",{className:"form-control form-control-solid py-2 px-6",placeholder:"T\xecm ki\u1ebfm"})]}),(0,k.jsxs)("div",{className:"filter-right",children:[(0,k.jsxs)("div",{className:"filter-row",children:[(0,k.jsxs)("div",{className:"filter-row_platform",children:[(0,k.jsx)("label",{className:"filter-row_label",children:"N\u1ec1n t\u1ea3ng"}),(0,k.jsx)(l.A,{sx:{m:1,minWidth:150},size:"small",children:(0,k.jsxs)(n.A,{labelId:"demo-select-small-label",id:"demo-select-small",value:null!==(t=s.platform)&&void 0!==t?t:"",onChange:e=>{const t={...s,page:1,platform:""!==e.target.value?e.target.value:""};o({pathname:r.pathname,search:p.stringify((0,j.pickBy)(t,j.identity))})},children:[(0,k.jsx)(i.A,{value:"",children:(0,k.jsx)("em",{children:"T\u1ea5t c\u1ea3"})}),d.Te.map((e=>(0,k.jsx)(i.A,{value:e,children:e},e)))]})})]}),(0,k.jsxs)("div",{className:"filter-row_platform",children:[(0,k.jsx)("label",{className:"filter-row_label",children:"S\u1eafp x\u1ebfp theo"}),(0,k.jsx)(l.A,{sx:{m:1,minWidth:150},size:"small",children:(0,k.jsx)(n.A,{labelId:"demo-select-small-label",id:"demo-select-small",value:null!==(a=s.sort)&&void 0!==a?a:c[0].sort,onChange:e=>{const t={...s,sort:e.target.value,page:1};o({pathname:r.pathname,search:p.stringify(t)})},children:c.map((e=>(0,k.jsx)(i.A,{value:e.sort,children:e.title},e.sort)))})})]})]}),(0,k.jsx)("div",{className:"filter-row_picker",children:(0,k.jsx)(m.oG,{showBot:!0,init:!h.form||!h.to,startDate:h.form?new Date(h.form):new Date,endDate:h.to?new Date(h.to):new Date,label:"Th\u1eddi gian \u0111\u0103ng k\xfd",onChange:e=>x({form:b()(e.selection.startDate).format("YYYY-MM-DD HH:mm:ss"),to:b()(e.selection.endDate).format("YYYY-MM-DD HH:mm:ss")}),onApply:()=>{const e={...s,page:1,from_date:h.form,to_date:h.to};o({pathname:r.pathname,search:p.stringify(e)})},onCancel:()=>{const e={...s,page:1,from_date:void 0,to_date:void 0};x({form:void 0,to:void 0}),o({pathname:r.pathname,search:p.stringify((0,j.pickBy)(e,j.identity))})}})})]})]})},C=e=>{let{data:t,qr:a}=e;const[s,l]=(0,u.useState)([]),{resultLoad:n,noti:i,onCloseNoti:r}=(0,_.JX)(),[c,h]=(0,u.useState)(!1),{mutate:f,isLoading:g}=(0,x.useMutation)({mutationFn:e=>o.$C.customers({...a,page:e,limit:15}),onSuccess:e=>l((t=>[...t,...e.data]))});return(0,u.useEffect)((()=>{c&&s.length>0&&s.length===(null===t||void 0===t?void 0:t.total)&&S(s).then((()=>{n({message:"Xu\u1ea5t File th\xe0nh c\xf4ng",color:"success"}),l([]),h(!1)})),s.length===(null===t||void 0===t?void 0:t.total)&&l([])}),[s,null===t||void 0===t?void 0:t.total]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(m.ce,{severity:i.color,message:i.message,open:i.openAlert,close:r}),(0,k.jsxs)(N.A,{color:"success",size:"medium",variant:"contained",onClick:()=>{if(0===t.data.length)return;if(!a.from_date||!a.to_date)return n({message:"Vui l\xf2ng ch\u1ecdn kho\u1ea3ng th\u1eddi gian",color:"warning"});if((0,d._n)(a.from_date?new Date(a.from_date):new Date,a.to_date?new Date(a.to_date):new Date).length>31)return n({message:"Xu\u1ea5t danh s\xe1ch t\u1ed1i \u0111a trong 30 ng\xe0y",color:"warning"});h(!0);for(var e=1;e<=(null===t||void 0===t?void 0:t.last_page);e++)f(e)},type:"button",loading:g,children:[(0,k.jsx)("i",{style:{marginRight:"4px",color:"var(--kt-white)"},className:"bi bi-download"}),"Xu\u1ea5t danh s\xe1ch"]})]})},S=e=>new Promise(((t,a)=>{const s=[["#","ID","H\u1ecd v\xe0 t\xean","Email","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i","N\u1ec1n t\u1ea3ng","Ng\xe0y \u0111\u0103ng k\xfd"],...e.map(((e,t)=>[t+1,e.id,e.fullname,e.email,e.telephone,e.platform,e.created_at]))],l=y.Wp.aoa_to_sheet(s);l["!cols"]=[{wch:5},{wch:10},{wch:35},{wch:25},{wch:25},{wch:25},{wch:25}];const n={Sheets:{data:l},SheetNames:["data"]},i=y.M9(n,{bookType:"xlsx",type:"array"}),r=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});w.saveAs(r,`ds_khach_hang_${b()().format("DDHHmmss")}.xlsx`),t(!0)}))},93511:(e,t,a)=>{a.d(t,{A:()=>l});a(65043);var s=a(70579);const l=function(e){const{title:t,element:a}=e;return(0,s.jsx)("div",{className:"toolbar",id:"kt_toolbar",children:(0,s.jsxs)("div",{id:"kt_toolbar_container",className:"container-fluid d-flex flex-stack",children:[(0,s.jsx)("h1",{className:"d-flex align-items-center text-dark fw-bolder my-1 fs-3",children:t}),a]})})}}}]);
//# sourceMappingURL=374.cf702fd0.chunk.js.map