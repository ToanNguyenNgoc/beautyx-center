"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[354],{68354:(e,l,a)=>{a.r(l),a.d(l,{default:()=>C});var i=a(93511),s=a(86971),n=a(84529),t=a(42807),o=a(56850),r=a(55854),d=a(63516),c=a(72812),m=a(86178),u=a.n(m),h=a(82025),p=a(81637),v=a(10611),x=a(82907),f=a(6171),g=a(73589),j=a(73033),_=a(53536),b=a(92823),N=a.n(b),y=(a(25884),a(70579));const C=function(){const e=(0,s.Zp)(),l=(0,s.g)(),{handlePostMedia:a,isLoading:m}=(0,h._r)(),{handlePostMedia:b,isLoading:C}=(0,h._r)(),{resultLoad:F,noti:V,onCloseNoti:k}=(0,h.JX)(),{mutateAsync:w,isLoading:Y}=(0,x.useMutation)({mutationFn:e=>l.id?g.UI.put(l.id,e):g.UI.post(e),onSuccess:()=>{F({message:l.id?"C\u1eadp nh\u1eadt promotion th\xe0nh c\xf4ng":"T\u1ea1o m\u1edbi promotion th\xe0nh c\xf4ng",color:"success"}),setTimeout((()=>e(-1)),1500)},onError:e=>{var l;F({color:"error",message:`C\xf3 l\u1ed7i x\u1ea3y ra. M\xe3 l\u1ed7i ${null===e||void 0===e||null===(l=e.request)||void 0===l?void 0:l.status}`})}}),D=(0,d.Wx)({initialValues:{name:"",content:"",media_url:"",main_media_id:void 0,thumbnail_url:"",thumbnail_media_id:void 0,is_popup:!1,valid_from:u()().format("YYYY-MM-DD HH:mm:ss"),valid_util:u()().format("YYYY-MM-DD HH:mm:ss"),discounts:[],productables:[],priority:0,url:"",token:"",color:"",platform:""},validationSchema:j.Ik({name:j.Yj().required("Nh\u1eadp t\xean c\u1ee7a promotion"),media_url:j.Yj().required("Upload h\xecnh c\u1ee7a promotion")}),onSubmit:async e=>{const{url:l,token:a,platform:i,color:s}=e,n=(0,_.pickBy)({...e,productables:e.productables.map((e=>e.id)),discounts:e.discounts.map((e=>e.id)),content:e.priority<0?JSON.stringify({url:l,token:a,platform:i,color:s}):e.content},_.identity);await w({...n,is_popup:e.is_popup?1:0})&&(D.setFieldValue("main_media_id",void 0),D.setFieldValue("thumbnail_media_id",void 0))}}),{refetch:q,isFetching:M}=(0,x.useQuery)({queryKey:[f.Eo.PROMOTION,l.id],queryFn:()=>g.UI.getDetail(l.id),enabled:!!l.id,onSuccess:e=>{D.setFieldValue("is_popup",1===e.context.is_popup),D.setFieldValue("name",e.context.name),D.setFieldValue("content",e.context.content),D.setFieldValue("media_url",e.context.media_url),D.setFieldValue("thumbnail_url",e.context.thumbnail_url),D.setFieldValue("valid_from",e.context.valid_from),D.setFieldValue("valid_util",e.context.valid_util),D.setFieldValue("productables",e.context.productables),D.setFieldValue("discounts",e.context.discounts),D.setFieldValue("priority",e.context.priority);try{const{url:l,token:a,platform:i,color:s}=JSON.parse(e.context.content);D.setFieldValue("url",l),D.setFieldValue("token",a),D.setFieldValue("platform",i),D.setFieldValue("color",s)}catch(l){}}});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.ce,{severity:V.color,message:V.message,open:V.openAlert,close:k}),(0,y.jsx)(i.A,{title:l.id?"C\u1eadp nh\u1eadt promotion":"T\u1ea1o m\u1edbi promotion"}),(0,y.jsx)("div",{className:"post d-flex flex-column-fluid",id:"kt_post",children:(0,y.jsx)("div",{className:"promotion-form",children:(0,y.jsxs)("form",{autoComplete:"off",onSubmit:D.handleSubmit,className:"form",children:[(0,y.jsxs)("div",{className:"flex-row align-items-center input-wrap",children:[(0,y.jsx)("div",{className:"wrap-item",children:(0,y.jsx)(r.Xg,{value:D.values.is_popup,onChange:e=>D.setFieldValue("is_popup",e.target.checked),label:"Is Popup"})}),(0,y.jsx)("div",{className:"wrap-item",children:(0,y.jsx)(r.Xg,{value:D.values.priority<0,onChange:e=>D.setFieldValue("priority",e.target.checked?-1:0),label:"Webview \u0111\u1ed1i t\xe1c"})})]}),D.values.priority<0&&(0,y.jsxs)("div",{style:{border:"solid 1px var(--kt-gray-500)",padding:6,borderRadius:6,margin:"6px 0px"},children:[(0,y.jsx)("div",{className:"required form-label",children:"C\xe0i \u0111\u1eb7t webview"}),(0,y.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,y.jsxs)("div",{className:"w-50",style:{paddingRight:6},children:[(0,y.jsx)("div",{className:"required form-label",children:"Link webview"}),(0,y.jsx)("input",{type:"text",value:D.values.url,onChange:D.handleChange,name:"url",className:"form-control form-control-solid mt-4 mb-2",placeholder:"URL..."})]}),(0,y.jsxs)("div",{className:"w-50",style:{paddingLeft:12},children:[(0,y.jsx)("div",{className:"required form-label",children:"Token"}),(0,y.jsx)("input",{type:"text",value:D.values.token,onChange:D.handleChange,name:"token",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Token"})]})]}),(0,y.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,y.jsxs)("div",{className:"w-50",style:{paddingRight:6},children:[(0,y.jsx)("div",{className:"required form-label",children:"Platform"}),(0,y.jsx)("input",{type:"text",value:D.values.platform,onChange:D.handleChange,name:"platform",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Platform..."})]}),(0,y.jsxs)("div",{className:"w-50",style:{paddingLeft:12},children:[(0,y.jsx)("div",{className:"required form-label",children:"Color"}),(0,y.jsx)("input",{type:"text",value:D.values.color,onChange:D.handleChange,name:"color",className:"form-control form-control-solid mt-4 mb-2",placeholder:"color"})]})]})]}),(0,y.jsxs)("div",{className:"column",children:[(0,y.jsx)("div",{className:"required form-label",children:"H\xecnh \u1ea3nh"}),(0,y.jsx)("div",{className:"drag-banner",children:(0,y.jsx)(n.l,{className:"form-input-file",style:{width:"100%"},multiple:!1,handleChange:e=>{D.setFieldValue("media_url","");a({e:{target:{files:[e]}},callBack(e){var l,a,i;D.setFieldValue("media_url",null!==(l=null===(a=e[0])||void 0===a?void 0:a.original_url)&&void 0!==l?l:""),D.setFieldValue("main_media_id",null===(i=e[0])||void 0===i?void 0:i.model_id)},version:"myspa"})},name:"file",types:t.Uv,children:(0,y.jsxs)("div",{className:"banner-form__img",children:[(0,y.jsx)("img",{src:""!==D.values.media_url?D.values.media_url:o.X.imgPlaceHolder,alt:"",className:"image-value"}),m&&(0,y.jsxs)("div",{className:"placeholder",children:[(0,y.jsx)("span",{children:"\u0110ang t\u1ea3i"}),(0,y.jsx)(p.A,{})]}),""===D.values.media_url&&(0,y.jsx)("div",{className:"placeholder",children:(0,y.jsx)("span",{children:"K\xe9o th\u1ea3 h\xecnh \u1ea3nh v\xe0o \u0111\xe2y ho\u1eb7c Click \u0111\u1ec3 ch\u1ecdn h\xecnh \u1ea3nh"})})]})})}),(0,y.jsx)("input",{type:"text",name:"image_url",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Ho\u1eb7c link h\xecnh \u1ea3nh...."}),D.errors.media_url&&D.touched.media_url&&(0,y.jsx)("span",{className:"text-danger",children:D.errors.media_url})]}),(0,y.jsx)("div",{className:"required form-label",children:"Thumbnail"}),(0,y.jsx)("div",{className:"drag-banner",children:(0,y.jsx)(n.l,{className:"form-input-file",style:{width:"100%"},multiple:!1,handleChange:e=>{D.setFieldValue("","");b({e:{target:{files:[e]}},callBack(e){var l,a,i;D.setFieldValue("thumbnail_url",null!==(l=null===(a=e[0])||void 0===a?void 0:a.original_url)&&void 0!==l?l:""),D.setFieldValue("thumbnail_media_id",null===(i=e[0])||void 0===i?void 0:i.model_id)},version:"myspa"})},name:"thumbnail",types:t.Uv,children:(0,y.jsxs)("div",{className:"banner-form__img",children:[(0,y.jsx)("img",{src:""!==D.values.thumbnail_url?D.values.thumbnail_url:o.X.imgPlaceHolder,alt:"",className:"image-value"}),""===D.values.thumbnail_url&&(0,y.jsxs)("div",{className:"placeholder",children:[(0,y.jsx)("span",{children:C?"\u0110ang t\u1ea3i":"K\xe9o th\u1ea3 h\xecnh \u1ea3nh v\xe0o \u0111\xe2y ho\u1eb7c Click \u0111\u1ec3 ch\u1ecdn h\xecnh \u1ea3nh"}),C&&(0,y.jsx)(v.A,{})]})]})})}),(0,y.jsx)("input",{value:D.values.thumbnail_url,onChange:D.handleChange,type:"text",name:"thumbnail_url",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Ho\u1eb7c link h\xecnh \u1ea3nh...."}),(0,y.jsxs)("div",{className:"column",children:[(0,y.jsx)("div",{className:"required form-label",children:"T\xean promotion"}),(0,y.jsx)("input",{value:D.values.name,onChange:D.handleChange,type:"text",name:"name",className:"form-control form-control-solid mt-4 mb-2",placeholder:"T\xean promotion...."}),D.errors.name&&D.touched.name&&(0,y.jsx)("span",{className:"text-danger",children:D.errors.name})]}),(0,y.jsxs)("div",{className:"column",children:[(0,y.jsx)("div",{className:"form-label",children:"M\xf4 t\u1ea3"}),(0,y.jsx)(N(),{theme:"snow",value:D.values.content,onChange:e=>D.setFieldValue("content",e)})]}),(0,y.jsx)("div",{className:"column",children:(0,y.jsx)(r.oG,{required:!0,startDate:new Date(D.values.valid_from),endDate:new Date(D.values.valid_util),onChange:e=>{D.setFieldValue("valid_from",u()(e.selection.startDate).format("YYYY-MM-DD HH:mm:ss")),D.setFieldValue("valid_util",u()(e.selection.endDate).format("YYYY-MM-DD HH:mm:ss"))}})}),(0,y.jsx)("div",{className:"column mt-6",children:(0,y.jsx)(r.a6,{productable:D.values.productables,onChangeProductable:e=>D.setFieldValue("productables",e)})}),(0,y.jsx)("div",{className:"column mt-6",children:(0,y.jsx)(r.Nv,{filterAll:!1,discounts:D.values.discounts,onChangeDiscounts:e=>D.setFieldValue("discounts",e)})}),(0,y.jsxs)("div",{className:"d-flex justify-content-end mt-8",children:[l.id&&(0,y.jsx)(c.A,{style:{marginRight:"8px"},loading:M,type:"submit",size:"large",color:"inherit",variant:"contained",onClick:()=>q(),children:"Kh\xf4i ph\u1ee5c"}),(0,y.jsx)(c.A,{loading:Y,type:"submit",size:"large",color:"success",variant:"contained",children:l.id?"C\u1eadp nh\u1eadt Promo":"T\u1ea1o m\u1edbi Promo"})]})]})})})]})}}}]);
//# sourceMappingURL=354.01e23d49.chunk.js.map