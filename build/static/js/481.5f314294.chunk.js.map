{"version":3,"file":"static/js/481.5f314294.chunk.js","mappings":"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","sources":["app/pages/organizations/index.tsx","components/TitlePage/index.tsx"],"sourcesContent":["import TitlePage from 'components/TitlePage';\nimport { IOrganization } from 'app/interface';\nimport { AppSnack, Avatar, XPagination } from 'components';\nimport { StatusOrgE } from 'app/util/fileType'\nimport { Link, useLocation, useNavigate } from 'react-router-dom';\nimport directRoute from 'app/routing/DirectRoute';\nimport { FC, useEffect, useState } from 'react';\nimport queryString from 'query-string'\nimport { FormControl, InputLabel, MenuItem, Select, SelectChangeEvent } from '@mui/material';\nimport { LoadingButton } from '@mui/lab';\nimport { useMutation, useQuery } from 'react-query';\nimport { orgApi } from 'app/api';\nimport { ResponseList } from '@types';\nimport { identity, pickBy } from 'lodash';\nimport * as FileSaver from \"file-saver\";\nimport * as XLSX from \"xlsx\"\nimport \"./organization.scss\"\nimport moment from 'moment';\nimport { useMessage } from 'app/hooks';\n\nfunction Organizations() {\n  const location = useLocation()\n  const navigate = useNavigate()\n  const qrPath = queryString.parse(location.search)\n  const { data } = useQuery({\n    queryKey: ['ORG', qrPath],\n    queryFn: () => orgApi.getAll({\n      page: qrPath.page || 1,\n      limit: 30,\n      is_ecommerce: qrPath.is_ecommerce || '',\n      sort: '-created_at'\n    }).then<ResponseList<IOrganization[]>>(res => res.data.context)\n  })\n  const onChangePage = (p: number) => {\n    const newQuery = {\n      ...qrPath,\n      page: p\n    }\n    navigate({\n      pathname: location.pathname,\n      search: queryString.stringify(newQuery)\n    })\n  }\n  return (\n    <>\n      <TitlePage\n        title=\"Danh sách doanh nghiệp\"\n      />\n      <div className={`card mb-5 mb-xl-8`}>\n        <div className='card-header border-0 pt-5'>\n          <h3 className='card-title align-items-start flex-column'>\n            <span className='card-label fw-bold fs-3 mb-1'>Danh sách doanh nghiệp</span>\n            <span className='text-muted mt-1 fw-semobold fs-7'>{data?.total} doanh nghiệp</span>\n          </h3>\n        </div>\n        <Filter data={data} />\n        <div className='card-body py-3'>\n          <div className='table-responsive'>\n            <table className='table align-middle gs-0 gy-4'>\n              <thead>\n                <tr className='fw-bold text-muted bg-light'>\n                  <th className='ps-4 min-w-300px rounded-start'>Thông tin</th>\n                  <th className='min-w-125px'>Liên lạc</th>\n                  <th className='min-w-125px'>Lượt thích</th>\n                  <th className='min-w-200px'>Trạng thái TMDT</th>\n                  <th className='min-w-100px'>Rating</th>\n                  <th className='min-w-150px text-end rounded-end'></th>\n                </tr>\n              </thead>\n              <tbody>\n                {\n                  data?.data?.map((org: IOrganization, index: number) => (\n                    <tr key={index} >\n                      <td>\n                        <div className='d-flex align-items-center'>\n                          <div className='symbol symbol-50px me-5'>\n                            <Avatar src={org.image_url} />\n                          </div>\n                          <div className='d-flex justify-content-start flex-column'>\n                            <span className='text-dark fw-bold text-hover-primary mb-1 fs-6'>\n                              {org.name}\n                            </span>\n                            <span className='text-muted fw-semobold text-muted d-block fs-7'>\n                              {org.full_address}\n                            </span>\n                          </div>\n                        </div>\n                      </td>\n                      <td>\n                        <span className='text-dark fw-bold text-hover-primary d-block mb-1 fs-7'>\n                          {org.telephone?.join(', ')}\n                        </span>\n                      </td>\n                      <td>\n                        <span className='text-dark fw-bold text-hover-primary d-block mb-1 fs-6'>\n                          {org.favorites_count}\n                        </span>\n                      </td>\n                      <td>\n                        <StatusOrgE status={org.is_momo_ecommerce_enable} />\n                      </td>\n                      <td>\n                        <div className='rating'>\n                          <div className='rating-label me-2 checked'>\n                            <i className='bi bi-star-fill fs-5'></i>\n                          </div>\n                          <div className='rating-label me-2 checked'>\n                            <i className='bi bi-star-fill fs-5'></i>\n                          </div>\n                          <div className='rating-label me-2 checked'>\n                            <i className='bi bi-star-fill fs-5'></i>\n                          </div>\n                          <div className='rating-label me-2 checked'>\n                            <i className='bi bi-star-fill fs-5'></i>\n                          </div>\n                          <div className='rating-label me-2 checked'>\n                            <i className='bi bi-star-fill fs-5'></i>\n                          </div>\n                        </div>\n                        <span className='text-muted fw-semobold text-muted d-block fs-7 mt-1'>\n                          Best Rated\n                        </span>\n                      </td>\n                      <td className='text-end'>\n                        {\n                          // METHOD?.includes(\"GET_BY_ID\") &&\n                          <Link\n                            to={{ pathname: directRoute.ORGANIZATIONS_DETAIL(org.id) }}\n                            className='btn btn-bg-light btn-color-muted btn-active-color-primary btn-sm px-4 me-2'\n                          >\n                            <i className=\"bi bi-eye fs-4\"></i>\n                          </Link>\n                        }\n                      </td>\n                    </tr>\n                  ))\n                }\n              </tbody>\n            </table>\n            <XPagination\n              totalPage={data?.last_page ?? 1}\n              onChangePage={onChangePage}\n              defaultPage={qrPath?.page ?? 1}\n            />\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\nconst Filter: FC<{ data?: ResponseList<IOrganization[]> }> = ({ data }) => {\n  const query = queryString.parse(useLocation().search) as any\n  const navigate = useNavigate()\n  const location = useLocation()\n  const onChangeOnBtx = (e: SelectChangeEvent) => {\n    const newQuery = {\n      ...query,\n      page: '',\n      is_ecommerce: e.target.value\n    }\n    navigate({\n      pathname: location.pathname,\n      search: queryString.stringify(pickBy(newQuery, identity))\n    })\n  }\n  return (\n    <div className=\"card-body filter-cnt\">\n      <div className=\"search\">\n        <input type=\"text\" className=\"form-control form-control-solid\" placeholder='Tìm kiếm MC' />\n      </div>\n      <div className=\"filter\">\n        <div className=\"filter-item\">\n          <FormControl style={{ width: '100%' }} size=\"small\">\n            <InputLabel id=\"demo-select-small-label\">Trạng thái TMDT</InputLabel>\n            <Select\n              labelId=\"demo-select-small-label\"\n              id=\"demo-select-small\"\n              label=\"Trạng thái TMDT\"\n              value={query.is_ecommerce || ''}\n              onChange={onChangeOnBtx}\n            >\n              <MenuItem value={''}>Tất cả</MenuItem>\n              <MenuItem value={'true'}>Đang mở</MenuItem>\n              <MenuItem value={'false'}>Đang đóng</MenuItem>\n            </Select>\n          </FormControl>\n        </div>\n        <div className=\"filter-item\">\n          {data && <Export query={query} data={data} />}\n        </div>\n      </div>\n    </div>\n  )\n}\nconst Export: FC<{ query: any, data: ResponseList<IOrganization[]> }> = ({ query, data }) => {\n  const [orgs, setOrgs] = useState<IOrganization[]>([])\n  const { resultLoad, noti, onCloseNoti } = useMessage()\n  const [isExport, setIsExport] = useState(false)\n  const { mutate, isLoading } = useMutation({\n    mutationFn: (page: number) => orgApi.getAll({\n      page,\n      is_ecommerce: query.is_ecommerce || '',\n      sort: '-created_at',\n      limit: 30,\n    }).then<ResponseList<IOrganization[]>>(res => res.data.context),\n    onSuccess: (res) => setOrgs(prev => [...prev, ...res.data])\n  })\n  const onExport = () => {\n    setIsExport(true)\n    for (var i = 1; i <= data?.last_page; i++) {\n      mutate(i)\n    }\n  }\n  useEffect(() => {\n    if (isExport && orgs.length > 0 && orgs.length === data?.total) {\n      onExportFile(orgs).then(() => {\n        resultLoad({ message: 'Xuất File thành công', color: 'success' })\n        setOrgs([])\n        setIsExport(false)\n      })\n    }\n    if (orgs.length === data?.total) setOrgs([])\n  }, [orgs, data?.total])\n\n  return (\n    <>\n      <AppSnack\n        severity={noti.color}\n        message={noti.message}\n        open={noti.openAlert}\n        close={onCloseNoti}\n      />\n      <LoadingButton onClick={onExport} loading={isLoading} color=\"success\" variant=\"contained\" size=\"medium\" >\n        Xuất DS\n      </LoadingButton>\n    </>\n  )\n}\nconst onExportFile = (customers: IOrganization[]) => {\n  return new Promise((resolve, reject) => {\n    const fileType =\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n    const fileExtension = \".xlsx\";\n    const titleRow = ['#', 'ID', 'Tên MC', 'Link gian hàng', 'Subdomain', 'Trạng thái', 'Ngày tạo'];\n    const dataWithTitles = [\n      titleRow,\n      ...customers.map((item, i) => [\n        i + 1, item.id, item.name, `https://beautyx.vn/cua-hang/${item.subdomain}`, item.subdomain,\n        item.is_momo_ecommerce_enable ? 'Đang mở' : 'Đang tắt', moment(item.created_at).format('DD/MM/YYYY')\n      ])\n    ];\n    const ws = XLSX.utils.aoa_to_sheet(dataWithTitles);\n    const columnWidths = [\n      { wch: 5 },\n      { wch: 10 },\n      { wch: 75 },\n      { wch: 45 },\n      { wch: 25 },\n      { wch: 25 },\n      { wch: 25 },\n    ];\n    ws['!cols'] = columnWidths;\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const data = new Blob([excelBuffer], { type: fileType });\n    FileSaver.saveAs(data, `ds_mc_${moment().format('DDHHmmss')}` + fileExtension);\n    resolve(true)\n  })\n}\nexport default Organizations;","import React from 'react';\nimport './style.scss'\n\ninterface IProps {\n    title: string\n    element?: JSX.Element\n}\n\nfunction TitlePage(props: IProps) {\n    const { title, element } = props;\n    return (\n        <div className='toolbar' id='kt_toolbar'>\n            <div id=\"kt_toolbar_container\" className='container-fluid d-flex flex-stack'>\n                <h1 className='d-flex align-items-center text-dark fw-bolder my-1 fs-3'>\n                    {title}\n                </h1>\n                {element}\n            </div>\n        </div>\n    );\n}\n\nexport default TitlePage;"],"names":["Filter","data","query","queryString","useLocation","search","navigate","useNavigate","location","className","type","placeholder","FormControl","style","width","size","InputLabel","id","Select","labelId","label","value","is_ecommerce","onChange","e","newQuery","page","target","pathname","pickBy","identity","MenuItem","Export","useState","orgs","setOrgs","useMessage","resultLoad","noti","onCloseNoti","isExport","setIsExport","useMutation","mutationFn","orgApi","sort","limit","then","res","context","onSuccess","prev","mutate","isLoading","useEffect","length","total","onExportFile","message","color","severity","open","openAlert","close","LoadingButton","onClick","i","last_page","loading","variant","customers","Promise","resolve","reject","dataWithTitles","map","item","name","subdomain","is_momo_ecommerce_enable","moment","created_at","format","ws","XLSX","wch","wb","Sheets","SheetNames","excelBuffer","bookType","Blob","FileSaver","qrPath","useQuery","queryKey","queryFn","TitlePage","title","org","index","src","image_url","full_address","telephone","join","favorites_count","status","to","directRoute","totalPage","onChangePage","p","defaultPage","props","element"],"sourceRoot":""}