"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[710],{85710:function(e,n,l){l.r(n),l.d(n,{default:function(){return D}});var i=l(1413),a=l(15861),t=l(64687),s=l.n(t),o=l(11838),r=l(16871),d=l(35058),u=l(35036),c=l(58702),m=l(66305),h=l(92506),p=l(39709),v=l(72426),f=l.n(v),x=l(65298),_=l(13239),g=l(57482),j=l(91933),b=l(52902),N=l(77356),y=l(76863),F=l(763),V=l(66770),C=l.n(V),k=(l(86009),l(80184));var D=function(){var e=(0,r.UO)(),n=(0,x.zX)(),l=n.handlePostMedia,t=n.isLoading,v=(0,x.zX)(),V=v.handlePostMedia,D=v.isLoading,Y=(0,x.UD)(),w=Y.resultLoad,M=Y.noti,H=Y.onCloseNoti,Z=(0,j.useMutation)({mutationFn:function(n){return e.id?N._N.put(e.id,n):N._N.post(n)},onSuccess:function(){return w({message:e.id?"C\u1eadp nh\u1eadt promotion th\xe0nh c\xf4ng":"T\u1ea1o m\u1edbi promotion th\xe0nh c\xf4ng",color:"success"})},onError:function(e){var n;w({color:"error",message:"C\xf3 l\u1ed7i x\u1ea3y ra. M\xe3 l\u1ed7i ".concat(null===e||void 0===e||null===(n=e.request)||void 0===n?void 0:n.status)})}}),q=Z.mutateAsync,P=Z.isLoading,T=(0,h.TA)({initialValues:{name:"",content:"",media_url:"",main_media_id:void 0,thumbnail_url:"",thumbnail_media_id:void 0,is_popup:!1,valid_from:f()().format("YYYY-MM-DD HH:mm:ss"),valid_util:f()().format("YYYY-MM-DD HH:mm:ss"),discounts:[],productables:[]},validationSchema:y.Ry({name:y.Z_().required("Nh\u1eadp t\xean c\u1ee7a promotion"),media_url:y.Z_().required("Upload h\xecnh c\u1ee7a promotion")}),onSubmit:function(){var e=(0,a.Z)(s().mark((function e(n){var l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,F.pickBy)((0,i.Z)((0,i.Z)({},n),{},{productables:n.productables.map((function(e){return e.id})),discounts:n.discounts.map((function(e){return e.id}))}),F.identity),e.next=3,q((0,i.Z)((0,i.Z)({},l),{},{is_popup:n.is_popup?1:0}));case 3:e.sent&&(T.setFieldValue("main_media_id",void 0),T.setFieldValue("thumbnail_media_id",void 0));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),S=(0,j.useQuery)({queryKey:[b.xG.PROMOTION,e.id],queryFn:function(){return N._N.getDetail(e.id)},enabled:!!e.id,onSuccess:function(e){T.setFieldValue("is_popup",1===e.context.is_popup),T.setFieldValue("name",e.context.name),T.setFieldValue("content",e.context.content),T.setFieldValue("media_url",e.context.media_url),T.setFieldValue("thumbnail_url",e.context.thumbnail_url),T.setFieldValue("valid_from",e.context.valid_from),T.setFieldValue("valid_util",e.context.valid_util),T.setFieldValue("productables",e.context.productables),T.setFieldValue("discounts",e.context.discounts)}}),z=S.refetch,A=S.isFetching;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(m.Ct,{severity:M.color,message:M.message,open:M.openAlert,close:H}),(0,k.jsx)(o.Z,{title:e.id?"C\u1eadp nh\u1eadt promotion":"T\u1ea1o m\u1edbi promotion"}),(0,k.jsx)("div",{className:"post d-flex flex-column-fluid",id:"kt_post",children:(0,k.jsx)("div",{className:"promotion-form",children:(0,k.jsxs)("form",{autoComplete:"off",onSubmit:T.handleSubmit,className:"form",children:[(0,k.jsx)("div",{className:"flex-row-sp align-items-center input-wrap",children:(0,k.jsx)("div",{className:"wrap-item",children:(0,k.jsx)(m.lQ,{value:T.values.is_popup,onChange:function(e){return T.setFieldValue("is_popup",e.target.checked)},label:"Is Popup"})})}),(0,k.jsxs)("div",{className:"column",children:[(0,k.jsx)("div",{className:"required form-label",children:"H\xecnh \u1ea3nh"}),(0,k.jsx)("div",{className:"drag-banner",children:(0,k.jsx)(d.b,{className:"form-input-file",style:{width:"100%"},multiple:!1,handleChange:function(e){T.setFieldValue("media_url",""),l({e:{target:{files:[e]}},callBack:function(e){var n,l,i;T.setFieldValue("media_url",null!==(n=null===(l=e[0])||void 0===l?void 0:l.original_url)&&void 0!==n?n:""),T.setFieldValue("main_media_id",null===(i=e[0])||void 0===i?void 0:i.model_id)},version:"myspa"})},name:"file",types:u.rh,children:(0,k.jsxs)("div",{className:"banner-form__img",children:[(0,k.jsx)("img",{src:""!==T.values.media_url?T.values.media_url:c.J.imgPlaceHolder,alt:"",className:"image-value"}),t&&(0,k.jsxs)("div",{className:"placeholder",children:[(0,k.jsx)("span",{children:"\u0110ang t\u1ea3i"}),(0,k.jsx)(_.Z,{})]}),""===T.values.media_url&&(0,k.jsx)("div",{className:"placeholder",children:(0,k.jsx)("span",{children:"K\xe9o th\u1ea3 h\xecnh \u1ea3nh v\xe0o \u0111\xe2y ho\u1eb7c Click \u0111\u1ec3 ch\u1ecdn h\xecnh \u1ea3nh"})})]})})}),(0,k.jsx)("input",{type:"text",name:"image_url",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Ho\u1eb7c link h\xecnh \u1ea3nh...."}),T.errors.media_url&&T.touched.media_url&&(0,k.jsx)("span",{className:"text-danger",children:T.errors.media_url})]}),(0,k.jsx)("div",{className:"required form-label",children:"Thumbnail"}),(0,k.jsx)("div",{className:"drag-banner",children:(0,k.jsx)(d.b,{className:"form-input-file",style:{width:"100%"},multiple:!1,handleChange:function(e){T.setFieldValue("",""),V({e:{target:{files:[e]}},callBack:function(e){var n,l,i;T.setFieldValue("thumbnail_url",null!==(n=null===(l=e[0])||void 0===l?void 0:l.original_url)&&void 0!==n?n:""),T.setFieldValue("thumbnail_media_id",null===(i=e[0])||void 0===i?void 0:i.model_id)},version:"myspa"})},name:"thumbnail",types:u.rh,children:(0,k.jsxs)("div",{className:"banner-form__img",children:[(0,k.jsx)("img",{src:""!==T.values.thumbnail_url?T.values.thumbnail_url:c.J.imgPlaceHolder,alt:"",className:"image-value"}),""===T.values.thumbnail_url&&(0,k.jsxs)("div",{className:"placeholder",children:[(0,k.jsx)("span",{children:D?"\u0110ang t\u1ea3i":"K\xe9o th\u1ea3 h\xecnh \u1ea3nh v\xe0o \u0111\xe2y ho\u1eb7c Click \u0111\u1ec3 ch\u1ecdn h\xecnh \u1ea3nh"}),D&&(0,k.jsx)(g.Z,{})]})]})})}),(0,k.jsx)("input",{value:T.values.thumbnail_url,onChange:T.handleChange,type:"text",name:"thumbnail_url",className:"form-control form-control-solid mt-4 mb-2",placeholder:"Ho\u1eb7c link h\xecnh \u1ea3nh...."}),(0,k.jsxs)("div",{className:"column",children:[(0,k.jsx)("div",{className:"required form-label",children:"T\xean promotion"}),(0,k.jsx)("input",{value:T.values.name,onChange:T.handleChange,type:"text",name:"name",className:"form-control form-control-solid mt-4 mb-2",placeholder:"T\xean promotion...."}),T.errors.name&&T.touched.name&&(0,k.jsx)("span",{className:"text-danger",children:T.errors.name})]}),(0,k.jsxs)("div",{className:"column",children:[(0,k.jsx)("div",{className:"form-label",children:"M\xf4 t\u1ea3"}),(0,k.jsx)(C(),{theme:"snow",value:T.values.content,onChange:function(e){return T.setFieldValue("content",e)}})]}),(0,k.jsx)("div",{className:"column",children:(0,k.jsx)(m.YS,{required:!0,minDate:new Date,startDate:new Date(T.values.valid_from),endDate:new Date(T.values.valid_util),onChange:function(e){T.setFieldValue("valid_from",f()(e.selection.startDate).format("YYYY-MM-DD HH:mm:ss")),T.setFieldValue("valid_util",f()(e.selection.endDate).format("YYYY-MM-DD HH:mm:ss"))}})}),(0,k.jsx)("div",{className:"column mt-6",children:(0,k.jsx)(m.Dk,{productable:T.values.productables,onChangeProductable:function(e){return T.setFieldValue("productables",e)}})}),(0,k.jsx)("div",{className:"column mt-6",children:(0,k.jsx)(m.G$,{filterAll:!1,discounts:T.values.discounts,onChangeDiscounts:function(e){return T.setFieldValue("discounts",e)}})}),(0,k.jsxs)("div",{className:"d-flex justify-content-end mt-8",children:[e.id&&(0,k.jsx)(p.Z,{style:{marginRight:"8px"},loading:A,type:"submit",size:"large",color:"inherit",variant:"contained",onClick:function(){return z()},children:"Kh\xf4i ph\u1ee5c"}),(0,k.jsx)(p.Z,{loading:P,type:"submit",size:"large",color:"success",variant:"contained",children:e.id?"C\u1eadp nh\u1eadt Promo":"T\u1ea1o m\u1edbi Promo"})]})]})})})]})}},11838:function(e,n,l){l.d(n,{Z:function(){return a}});l(72791);var i=l(80184);var a=function(e){var n=e.title,l=e.element;return(0,i.jsx)("div",{className:"toolbar",id:"kt_toolbar",children:(0,i.jsxs)("div",{id:"kt_toolbar_container",className:"container-fluid d-flex flex-stack",children:[(0,i.jsx)("h1",{className:"d-flex align-items-center text-dark fw-bolder my-1 fs-3",children:n}),l]})})}}}]);
//# sourceMappingURL=710.3013571d.chunk.js.map