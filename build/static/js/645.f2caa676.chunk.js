"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[645,704],{95039:function(e,i,n){n.d(i,{l:function(){return g}});var a=n(42982),r=n(37762),t=n(15861),l=n(70885),s=n(64687),o=n.n(s),c=n(72791),d=(n(71755),n(81918)),u=n(93044),m=n(13239),v=n(36763),h=n(763),f=n(35036),x=n(80184),g=function(e){var i,n,s=e.orgsChoose,g=void 0===s?[]:s,p=e.values,j=void 0===p?[]:p,b=e.setValues,N=e.onChangeService,y=(0,c.useRef)(null),_=j.map((function(e){return e.id})),k=(0,c.useState)({data:[],load:!1}),C=(0,l.Z)(k,2),Z=C[0],w=C[1],T=function(e){var i,n,a,r;if(g.length>0&&"show"===e)return null===(a=y.current)||void 0===a||null===(r=a.classList)||void 0===r?void 0:r.add("box-services-show");if("hide"===e)return null===(i=y.current)||void 0===i||null===(n=i.classList)||void 0===n?void 0:n.remove("box-services-show")};window.addEventListener("click",(function(){return T("hide")}));var F=function(){var e=(0,t.Z)(o().mark((function e(i,n){var a,t,l,s,c,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],t=(0,r.Z)(n),e.prev=2,t.s();case 4:if((l=t.n()).done){e.next=13;break}return s=l.value,e.next=8,v.Z.getServicesByOrg({keyword:i,org_id:null===s||void 0===s?void 0:s.id});case 8:c=e.sent,d={services:null===c||void 0===c?void 0:c.data.context.data,org:s},a.push(d);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.e(e.t0);case 18:return e.prev=18,t.f(),e.finish(18);case 21:w({data:a,load:!1});case 22:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})));return function(i,n){return e.apply(this,arguments)}}(),S=(0,c.useCallback)((0,h.debounce)((function(e,i){w({data:[],load:!0}),F(e,i)}),1500),[]),V=null!==(i=null===(n=Z.data)||void 0===n?void 0:n.map((function(e){return e.services})).flat())&&void 0!==i?i:[],q=function(e){if(N){var i=j.findIndex((function(i){return i.id===e.id}));N(i<0?[].concat((0,a.Z)(j),[e]):j.filter((function(i){return i.id!==e.id})))}else b&&b((function(i){return i.findIndex((function(i){return i.id===e.id}))<0?i=[].concat((0,a.Z)(i),[e]):i.filter((function(i){return i.id!==e.id}))}))};return(0,x.jsxs)("div",{className:"select-services",children:[(0,x.jsx)("label",{className:"required form-label",children:"S\u1ea3n ph\u1ea9m \xe1p d\u1ee5ng"}),(0,x.jsx)("div",{onClick:function(e){e.stopPropagation(),T("show")},className:"form-control form-control-solid ser-selected",children:j.map((function(e){return(0,x.jsx)(d.Z,{label:"".concat(e.service_name," | Gi\xe1 g\u1ed1c: ").concat((0,f.T4)(e.price)),onDelete:function(){return q(e)},size:"medium",color:"primary",avatar:(0,x.jsx)(u.Z,{src:e.image_url})},e.id)}))}),(0,x.jsxs)("div",{onClick:function(e){return e.stopPropagation()},ref:y,className:"box-services",children:[(0,x.jsxs)("div",{className:"box-service-input",children:[Z.load&&(0,x.jsx)(m.Z,{size:16}),(0,x.jsx)("input",{onChange:function(e){g&&g.length>0&&S(e.target.value,g)},type:"text",className:"form-control form-control-solid",placeholder:"T\xecm ki\u1ebfm d\u1ecbch v\u1ee5..."})]}),(0,x.jsx)("div",{className:"services-list",children:(0,x.jsx)("ul",{children:V.filter(Boolean).map((function(e,i){return(0,x.jsx)("li",{children:(0,x.jsxs)("div",{style:_.includes(e.id)?{backgroundColor:"var(--kt-gray-200)"}:{},onClick:function(){return q(e)},className:"service-item",children:[(0,x.jsx)("div",{className:"image",children:(0,x.jsx)("img",{src:e.image_url,onError:function(e){return(0,f.bW)(e)},alt:""})}),(0,x.jsxs)("div",{className:"service-detail",children:[(0,x.jsx)("p",{className:"service-name",children:e.service_name}),(0,x.jsx)("p",{className:"service-price",children:(0,f.T4)(e.price)})]})]})},i)}))})})]})]})}},52645:function(e,i,n){n.r(i),n.d(i,{default:function(){return j}});var a=n(1413),r=n(70885),t=n(11838),l=n(92506),s=n(72791),o=n(16871),c=n(65298),d=n(35036),u=n(58702),m=n(13239),v=n(91933),h=n(8423),f=n(39709),x=n(66305),g=n(95039),p=n(80184);var j=function(){var e,i=(0,o.UO)(),n=(0,c.UD)(),j=n.resultLoad,b=n.noti,N=n.onCloseNoti,y=(0,c.zX)().handlePostMedia,_=(0,s.useState)(),k=(0,r.Z)(_,2),C=k[0],Z=k[1],w=(0,s.useState)([]),T=(0,r.Z)(w,2),F=T[0],S=T[1],V=(0,c.zX)(),q=V.handlePostMedia,z=V.isLoading,L=(0,v.useMutation)({mutationFn:function(e){return i.id?h.H5.putTrend(i.id,e):h.H5.postTrend(e)},onSuccess:function(){return i.id?j({message:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng"}):j({message:"T\u1ea1o m\u1edbi th\xe0nh c\xf4ng"})},onError:function(e){var i;j({color:"error",message:"C\xf3 l\u1ed7i x\u1ea3y ra. M\xe3 l\u1ed7i ".concat(null===e||void 0===e||null===(i=e.request)||void 0===i?void 0:i.status)})}}),H=L.mutate,P=L.isLoading,R=(0,l.TA)({initialValues:{media_url:"",image_thumb:"",title:"",content:"",trend_url:""},onSubmit:function(e){H((0,a.Z)((0,a.Z)({},e),{},{organization_id:null===C||void 0===C?void 0:C.id,services:F.map((function(e){return e.id}))}))}}),O=(0,v.useQuery)({queryKey:["TREND",i.id],queryFn:function(){return h.H5.trend(i.id)},enabled:!!i.id,onSuccess:function(e){var i=e.context,n=i.services;S(n),R.setFieldValue("media_url",i.media_url),R.setFieldValue("image_thumb",i.image_thumb),R.setFieldValue("title",i.title),R.setFieldValue("content",i.content),R.setFieldValue("trend_url",i.trend_url)}}),B=O.refetch,E=O.isRefetching,M=O.data;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(x.Ct,{severity:b.color,message:b.message,open:b.openAlert,close:N}),(0,p.jsx)(t.Z,{title:i.id?"Thay \u0111\u1ed5i n\u1ed9i dung":"Th\xeam m\u1edbi"}),(0,p.jsx)("div",{className:"container",children:(0,p.jsxs)("form",{onSubmit:R.handleSubmit,className:"trend-form",children:[(0,p.jsxs)("div",{className:"video d-flex justify-content-between",children:[(0,p.jsxs)("div",{className:"video-left",children:[(0,p.jsx)("div",{className:"required form-label",children:"Video"}),(0,p.jsxs)("div",{className:"drag-video",children:[z&&(0,p.jsxs)("div",{className:"drag-video-load",children:["\u0110ang t\u1ea3i video l\xean...",(0,p.jsx)(m.Z,{})]}),""===R.values.media_url?(0,p.jsx)("img",{src:u.J.imgPlaceHolder,alt:""}):(0,p.jsx)("video",{controls:!0,children:(0,p.jsx)("source",{src:R.values.media_url})})]}),(0,p.jsxs)("div",{className:"input-video",children:[(0,p.jsx)("input",{onChange:function(e){q({e:e,callBack:function(e){var i;return R.setFieldValue("media_url",null===(i=e[0])||void 0===i?void 0:i.original_url)},version:"api.beautyx",resetOriginalResult:!0})},hidden:!0,type:"file",accept:d.lj,id:"video"}),(0,p.jsx)("label",{htmlFor:"video",className:"btn btn-primary btn-up-img",children:(0,p.jsx)("i",{className:"bi bi-arrow-bar-up"})}),(0,p.jsx)("input",{onChange:R.handleChange,name:"media_url",value:R.values.media_url,type:"text",className:"form-control form-control-solid mt-4",placeholder:"Ho\u1eb7c video url..."})]})]}),(0,p.jsxs)("div",{className:"video-right",children:[(0,p.jsx)("div",{className:"required form-label",children:"Image thumbnail"}),(0,p.jsx)("div",{className:"drag-image",children:(0,p.jsx)("img",{src:R.values.image_thumb||u.J.imgPlaceHolder,alt:""})}),(0,p.jsxs)("div",{className:"input-img",children:[(0,p.jsx)("input",{onChange:function(e){y({e:e,callBack:function(e){var i;return R.setFieldValue("image_thumb",null===(i=e[0])||void 0===i?void 0:i.original_url)},version:"api.beautyx",resetOriginalResult:!0})},hidden:!0,type:"file",accept:d.to,id:"up-img"}),(0,p.jsx)("label",{htmlFor:"up-img",className:"btn btn-primary btn-up-img",children:(0,p.jsx)("i",{className:"bi bi-arrow-bar-up"})}),(0,p.jsx)("input",{onChange:R.handleChange,value:R.values.image_thumb,name:"image_thumb",type:"text",className:"form-control form-control-solid mt-4",placeholder:"Ho\u1eb7c image url..."})]})]})]}),(0,p.jsxs)("div",{className:"col mt-4",children:[(0,p.jsx)("div",{className:"required form-label",children:"Ti\xeau \u0111\u1ec1"}),(0,p.jsx)("input",{type:"text",onChange:R.handleChange,value:R.values.title,name:"title",className:"form-control form-control-solid",placeholder:"Ti\xeau \u0111\u1ec1"})]}),(0,p.jsxs)("div",{className:"col mt-4",children:[(0,p.jsx)("div",{className:"required form-label",children:"N\u1ed9i dung"}),(0,p.jsx)("input",{type:"text",onChange:R.handleChange,value:R.values.content,name:"content",className:"form-control form-control-solid",placeholder:"N\u1ed9i dung"})]}),(0,p.jsxs)("div",{className:"col mt-4",children:[(0,p.jsx)("div",{className:"required form-label",children:"Link tiktok"}),(0,p.jsx)("input",{type:"text",onChange:R.handleChange,value:R.values.trend_url,name:"trend_url",className:"form-control form-control-solid",placeholder:"Link tiktok"})]}),(0,p.jsxs)("div",{className:"mt-4",children:[(0,p.jsx)(x.QN,{organization_id:null===M||void 0===M||null===(e=M.context)||void 0===e?void 0:e.organization_id,origin:C,setOrigin:Z}),(0,p.jsx)("div",{className:"mt-4",children:(0,p.jsx)(g.l,{orgsChoose:C?[C]:[],values:F,setValues:S})})]}),(0,p.jsxs)("div",{className:"d-flex justify-content-end mt-8",children:[i.id&&(0,p.jsx)(f.Z,{style:{marginRight:"8px"},onClick:function(){return B()},loading:E,type:"button",variant:"contained",color:"primary",size:"large",children:"Kh\xf4i ph\u1ee5c"}),(0,p.jsx)(f.Z,{loading:P,type:"submit",variant:"contained",color:"success",size:"large",children:i.id?"L\u01b0u thay \u0111\u1ed5i":"T\u1ea1o m\u1edbi"})]})]})})]})}},11838:function(e,i,n){n.d(i,{Z:function(){return r}});n(72791);var a=n(80184);var r=function(e){var i=e.title,n=e.element;return(0,a.jsx)("div",{className:"toolbar",id:"kt_toolbar",children:(0,a.jsxs)("div",{id:"kt_toolbar_container",className:"container-fluid d-flex flex-stack",children:[(0,a.jsx)("h1",{className:"d-flex align-items-center text-dark fw-bolder my-1 fs-3",children:i}),n]})})}},71755:function(){}}]);
//# sourceMappingURL=645.f2caa676.chunk.js.map