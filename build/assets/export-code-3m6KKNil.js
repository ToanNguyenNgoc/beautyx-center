import{a as l,V as x,bZ as w,j as r,b_ as E,b$ as _,c0 as b,aD as y}from"./index-BlvkBlq-.js";import{d as T}from"./discounts-2Xzsal-3.js";import{L as C}from"./LoadingButton-DGqjgf5H.js";const k=({discount:o,title:m=" Xuất mã giảm giá",size:u="medium"})=>{const[a,d]=l.useState(1),n=30,[s,i]=l.useState([]),{mutate:p,data:e,isLoading:g}=x({mutationKey:["GET_CODE",o.uuid],mutationFn:t=>T.getCodeIsCampaign({uuid:o.uuid,page:t.page,limit:n}),onSuccess(t){const f=t.data;i(h=>h=[...h,...f]),d(Math.ceil(t.total/n))}}),c=()=>{i([]),d(1),p({page:1})};return l.useEffect(()=>{if(a>1)for(let t=2;t<=a;t++)p({page:t})},[a]),l.useEffect(()=>{s.length===(e==null?void 0:e.total)&&S({file_name:w(o.title),codes:s})},[s,e==null?void 0:e.total]),r.jsx(r.Fragment,{children:r.jsxs(C,{color:"success",size:u,variant:"contained",onClick:c,type:"button",loading:g,children:[r.jsx("i",{style:{marginRight:"4px",color:"var(--kt-white)"},className:"bi bi-download"}),m]})})},S=({file_name:o,codes:m})=>{const u="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",a=".xlsx",n=[["STT","Danh sách mã","Trạng thái sử dụng"],...m.map((c,t)=>[t+1,c.coupon_code,c.status==="1"?"Chưa sử dụng":"Đã sử dụng"])],s=E.aoa_to_sheet(n),i=[{wch:8},{wch:35},{wch:25}];s["!cols"]=i;const e=_({Sheets:{data:s},SheetNames:["data"]},{bookType:"xlsx",type:"array"}),g=new Blob([e],{type:u});b.saveAs(g,`Ma_giam_gia_${o}_${y().format("DDHHmmss")}`+a)};export{k as E};
