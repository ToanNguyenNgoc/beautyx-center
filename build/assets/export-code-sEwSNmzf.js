import{a as l,V as w,bZ as E,j as r,b_ as _,b$ as b,c0 as y,aD as T,a7 as C}from"./index-Cy0ECsl2.js";import{L as S}from"./LoadingButton-BnUDQfN1.js";const k=({discount:s,title:m=" Xuất mã giảm giá",size:u="medium"})=>{const[a,d]=l.useState(1),n=30,[o,i]=l.useState([]),{mutate:g,data:e,isLoading:p}=w({mutationKey:["GET_CODE",s.uuid],mutationFn:t=>C.Discount.getCodeCampaign({uuid:s.uuid,page:t.page,limit:n}),onSuccess(t){var h;const f=(h=t.context)==null?void 0:h.data;i(x=>x=[...x,...f]),d(Math.ceil(t.context.total/n))}}),c=()=>{i([]),d(1),g({page:1})};return l.useEffect(()=>{if(a>1)for(let t=2;t<=a;t++)g({page:t})},[a]),l.useEffect(()=>{o.length===(e==null?void 0:e.context.total)&&D({file_name:E(s.title),codes:o})},[o,e==null?void 0:e.context.total]),r.jsx(r.Fragment,{children:r.jsxs(S,{color:"success",size:u,variant:"contained",onClick:c,type:"button",loading:p,children:[r.jsx("i",{style:{marginRight:"4px",color:"var(--kt-white)"},className:"bi bi-download"}),m]})})},D=({file_name:s,codes:m})=>{const u="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",a=".xlsx",n=[["STT","Danh sách mã","Trạng thái sử dụng"],...m.map((c,t)=>[t+1,c.coupon_code,c.status==="1"?"Chưa sử dụng":"Đã sử dụng"])],o=_.aoa_to_sheet(n),i=[{wch:8},{wch:35},{wch:25}];o["!cols"]=i;const e=b({Sheets:{data:o},SheetNames:["data"]},{bookType:"xlsx",type:"array"}),p=new Blob([e],{type:u});y.saveAs(p,`Ma_giam_gia_${s}_${T().format("DDHHmmss")}`+a)};export{k as E};
