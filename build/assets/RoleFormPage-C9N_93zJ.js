import{ci as S,Q as A,bw as z,j as i,aT as _,aS as $,a as h,aU as E,aK as T,aP as x,aW as M,aX as D,aY as k,aZ as R,cL as q,a$ as L,ch as V,a8 as X,e as F,ae as O,V as U,as as G,a9 as H,ax as N}from"./index-B-8ZwVwN.js";import{r as j}from"./roleAndPermissionApi-CBqNOVxU.js";import{X as K}from"./index-BCQ4_G9L.js";import{T as I}from"./Tooltip-hAocn3Us.js";import"./LoadingButton-CddcXNEg.js";import"./Popper-CqAISdK9.js";function Q(){const{hasEnabled:n}=S(),{data:t}=A({queryKey:["roleAndPermissionApi.permissions"],queryFn:()=>j.permissions().then(e=>e.data),enabled:n("v1.permissions.index")}),s=(t==null?void 0:t.context)||[],r=[{name:"roles",desc:"Phân quyền",permissions:s.filter(e=>e.name.includes("roles"))},{name:"permissions",desc:"Permissions",permissions:s.filter(e=>e.name.includes("permissions"))},{name:"admin.users",desc:"Người dùng",permissions:s.filter(e=>e.name.includes("admin.users"))},{name:"banners",desc:"Banner",permissions:s.filter(e=>e.name.includes("banners"))},{name:"discounts",desc:"Giảm giá",permissions:s.filter(e=>e.name.includes("discounts"))},{name:"promotions",desc:"Promotions",permissions:s.filter(e=>e.name.includes("promotions"))},{name:"beautyx.tips",desc:"BeautyX tips",permissions:s.filter(e=>e.name.includes("beautyx.tips"))},{name:"trends",desc:"BeautyX Video",permissions:s.filter(e=>e.name.includes("trends"))},{name:"beautyx.notification",desc:"Push thông báo BeautyX",permissions:s.filter(e=>e.name.includes("beautyx.notification"))},{name:"organizations.updateECommerce",desc:"Cửa hàng",permissions:s.filter(e=>e.name.includes("organizations.updateECommerce"))},{name:"admin.orders",desc:"Danh sách đơn hàng",permissions:s.filter(e=>e.name.includes("admin.orders"))},{name:"admin.appointments",desc:"Danh sách lịch hẹn",permissions:s.filter(e=>e.name.includes("admin.appointments"))},{name:"admin.comments",desc:"Danh sách bình luận",permissions:s.filter(e=>e.name.includes("admin.comments"))},{name:"versions",desc:"Danh sách phiên bản phần mềm",permissions:s.filter(e=>e.name.includes("versions"))},{name:"brand_apps",desc:"Danh sách phiên bản App thương hiệu",permissions:s.filter(e=>e.name.includes("brand_apps"))},{name:"brand_app_versions",desc:"Danh sách phiên bản Bundle app thương hiệu",permissions:s.filter(e=>e.name.includes("brand_app_versions"))}];return{permissions:s,permissionsGroup:r}}const W=z(i.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Y=z(i.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Z=z(i.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function J(n){return $("MuiCheckbox",n)}const w=_("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),ee=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],se=n=>{const{classes:t,indeterminate:s,color:r,size:e}=n,l={root:["root",s&&"indeterminate",`color${k(r)}`,`size${k(e)}`]},u=R(l,J,t);return x({},t,u)},ne=M(q,{shouldForwardProp:n=>L(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.indeterminate&&t.indeterminate,t[`size${k(s.size)}`],s.color!=="default"&&t[`color${k(s.color)}`]]}})(({theme:n,ownerState:t})=>x({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${t.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:V.alpha(t.color==="default"?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${w.checked}, &.${w.indeterminate}`]:{color:(n.vars||n).palette[t.color].main},[`&.${w.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),ie=i.jsx(Y,{}),oe=i.jsx(W,{}),te=i.jsx(Z,{}),B=h.forwardRef(function(t,s){var r,e;const l=E({props:t,name:"MuiCheckbox"}),{checkedIcon:u=ie,color:m="primary",icon:f=oe,indeterminate:p=!1,indeterminateIcon:v=te,inputProps:g,size:d="medium",className:b}=l,y=T(l,ee),C=p?v:f,o=p?v:u,a=x({},l,{color:m,indeterminate:p,size:d}),c=se(a);return i.jsx(ne,x({type:"checkbox",inputProps:x({"data-indeterminate":p},g),icon:h.cloneElement(C,{fontSize:(r=C.props.fontSize)!=null?r:d}),checkedIcon:h.cloneElement(o,{fontSize:(e=o.props.fontSize)!=null?e:d}),ownerState:a,ref:s,className:D(c.root,b)},y,{classes:c}))}),he=()=>{const n=X(),{hasEnabled:t}=S(),s=F().state,r=O(),e=r!=null&&r.id?"update":"store",[l,u]=h.useState(s||""),[m,f]=h.useState([]);A({queryKey:["roleAndPermissionApi.role",r.id],queryFn:()=>j.role(Number(r.id)).then(o=>o.data),enabled:!!(e==="update"&&t("v1.roles.show")),onSuccess:o=>{f(o.context)}});const{mutate:p,isLoading:v}=U({mutationFn:o=>e==="update"?j.roleUpdate(Number(r.id),o):j.roleCreate(o),onSuccess:()=>{N.open({title:"Thành công",type:"success"}),setTimeout(()=>n(-1),1e3)},onError:()=>N.open({title:"Có lỗi xảy ra",type:"error"})}),{permissionsGroup:g}=Q(),d=o=>{Array.isArray(o)?o.forEach(a=>b(a)):b(o)},b=o=>{f(a=>{let c=[...a];return a.findIndex(P=>P.id===o.id)<0?c=[...c,o]:c=c.filter(P=>P.id!==o.id),c})},y=o=>o.filter(a=>m.map(c=>c.name).includes(a.name)).length===o.length,C=()=>{if(l.trim()==="")return N.open({title:"Vui lòng nhập tên",type:"warning"});p({name:s===l?void 0:l,permissions_id:m.map(o=>o.id)})};return i.jsx(G,{permissions:e==="store"?["v1.roles.store"]:["v1.roles.show","v1.roles.patch"],showEmpty:!0,children:i.jsxs("div",{children:[i.jsx(H,{title:e==="store"?"Thêm mới":"Cập nhật"}),i.jsxs("div",{className:"card p-6",children:[i.jsx("div",{className:"flex-row-sp input-wrap w-50",children:i.jsxs("div",{className:"wrap-item mb-4 w-100",children:[i.jsx("label",{className:"form-label fw-bold",children:"Tên quyền"}),i.jsx("input",{onChange:o=>u(o.target.value),value:l,name:"priority",className:"form-control form-control-solid w-100",placeholder:"Tên quyền"})]})}),i.jsx("div",{className:"post d-flex flex-column-fluid",id:"kt_post",children:i.jsx("div",{className:"w-100",children:g.map(o=>i.jsxs("div",{className:"mb-4",children:[i.jsx("span",{className:"fw-bold",children:o.desc}),i.jsxs("div",{className:"w-100 d-flex",children:[i.jsx("div",{style:{width:"14.2%",cursor:"pointer"},onClick:()=>{y(o.permissions)?d(o.permissions):d(o.permissions.filter(a=>!m.map(c=>c.name).includes(a.name)))},children:i.jsx(I,{title:"all",placement:"top",arrow:!0,children:i.jsxs("div",{children:[i.jsx(B,{readOnly:!0,checked:y(o.permissions)}),i.jsx("span",{children:"Tất cả"})]})})}),ae(o.permissions).map(a=>i.jsx("div",{style:{width:"14.2%",cursor:"pointer"},onClick:()=>d(a),children:i.jsx(I,{title:a.name,placement:"top",arrow:!0,children:i.jsxs("div",{children:[i.jsx(B,{readOnly:!0,checked:!!m.find(c=>c.id===a.id)}),i.jsx(re,{name:a.name})]})})},a.id))]})]},o.name))})}),i.jsx("div",{className:"d-flex justify-content-end",children:i.jsx(K,{onClick:C,loading:v,title:e==="store"?"Thêm mới":"Cập nhật",color:"success"})})]})]})})},ae=n=>["index","show","store","update","patch","destroy","sendNotification"].map(s=>n.find(e=>e.name.includes(s))).filter(Boolean),re=({name:n})=>{const t=()=>{let s="";return n.includes("index")&&(s="Danh sách"),n.includes("show")&&(s="Chi tiết"),(n.includes("store")||n.includes("sendNotification"))&&(s="Tạo mới"),(n.includes("patch")||n.includes("update"))&&(s="Cập nhật"),n.includes("destroy")&&(s="Xóa"),s};return i.jsx("span",{children:t()})};export{he as default};
