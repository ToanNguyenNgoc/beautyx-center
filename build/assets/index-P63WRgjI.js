import{aj as v,ai as y,a7 as u,e as k,X as w,ak as A,j as s,a8 as P,al as _,am as D,a9 as R,V as C,an as T,t as b,a2 as p,ao as Y}from"./index-CJshWYnI.js";import{u as F,A as M}from"./index-BQCm6EIb.js";function $(a,r,e){var m,x,h,j,g;let i="";const{data:t,error:d,isValidating:o}=v(r,f=>fetch(`${f}${i}`,y()).then(N=>N.json()),{revalidateOnFocus:!1});let l,n=1,c=1;return t&&(l=((m=t.data)==null?void 0:m.context)??t,n=(h=(x=t.data)==null?void 0:x.context)==null?void 0:h.total_page,c=(g=(j=t.data)==null?void 0:j.context)==null?void 0:g.total),{response:l,error:d,isValidating:o,totalPage:n,totalItem:c}}function S(){var l;const a=u(),r=k(),e=w(),{totalPage:i,response:t,isValidating:d}=$(!0,`${A.TRENDS}?page=${(e==null?void 0:e.page)??1}&include=services`),o=n=>{a({pathname:r.pathname,search:`page=${n}`})};return s.jsxs(s.Fragment,{children:[s.jsx(P,{title:"Trends",element:s.jsx(_,{size:"large",color:"success",variant:"contained",onClick:()=>a("/pages/trend-form"),children:"Tạo mới"})}),s.jsxs("div",{className:"card mb-5 mb-xl-8",children:[s.jsx("div",{className:"card-header border-0 pt-5",children:s.jsx("h3",{className:"card-title align-items-start flex-column",children:s.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Bài đăng"})})}),s.jsx("div",{className:"card-body py-3",children:s.jsxs("div",{className:"table-responsive",children:[s.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"fw-bold text-muted",children:[s.jsx("th",{className:"min-w-100px",children:"Bài đăng"}),s.jsx("th",{className:"min-w-70px",children:"Thumbnail"}),s.jsx("th",{className:"min-w-140px",children:"Doanh nghiệp"}),s.jsx("th",{className:"min-w-140px",children:"Dịch vụ được gán"}),s.jsx("th",{className:"min-w-120px",children:"Ngày đăng"}),s.jsx("th",{className:"min-w-120px",children:"Ngày sửa"}),s.jsx("th",{className:"min-w-100px",children:"Actions"})]})}),s.jsx("tbody",{children:(l=t==null?void 0:t.data)==null?void 0:l.map(n=>s.jsx(E,{item:n},n._id))})]}),s.jsx(D,{loading:d})]})})]}),s.jsx(R,{onChangePage:o,totalPage:i,defaultPage:(e==null?void 0:e.page)??1})]})}const E=({item:a})=>{var n;const r=u(),{noti:e,resultLoad:i,onCloseNoti:t}=F(),d=c=>{r(`/pages/trend-form/${c._id}`)},{mutate:o,isLoading:l}=C({mutationFn:()=>T.refreshComment(a._id),onSuccess:()=>i({color:"success",message:"Refresh trend success"}),onError:()=>i({color:"error",message:"Refresh trend fail"})});return s.jsxs(s.Fragment,{children:[s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"symbol symbol-45px me-5",children:s.jsx("img",{src:b(a.organization_image),alt:""})}),s.jsx("div",{className:"d-flex justify-content-start flex-column",children:s.jsx("span",{className:"text-dark fw-bold fs-6",children:a.title})})]})}),s.jsx("td",{children:s.jsx("div",{className:"symbol symbol-75px me-5",children:s.jsx("img",{style:{objectFit:"contain"},src:b(a.image_thumb),alt:""})})}),s.jsx("td",{children:s.jsx("span",{className:"text-dark fw-bold d-block fs-6",children:a.organization_name})}),s.jsx("td",{children:(n=a.services)==null?void 0:n.map(c=>s.jsx("p",{className:"text-dark d-block fs-6",children:c.service_name},c.id))}),s.jsx("td",{children:s.jsx("span",{className:"text-dark d-block fs-7",children:p(a.createdAt).format("DD/MM/YYYY")})}),s.jsx("td",{children:s.jsx("span",{className:"text-dark d-block fs-7",children:p(a.updatedAt).format("DD/MM/YYYY")})}),s.jsx("td",{children:s.jsxs("div",{className:"d-flex justify-content-end flex-shrink-0",children:[s.jsx("button",{onClick:()=>d(a),style:{marginRight:"6px"},className:"btn btn-bg-light btn-color-muted btn-active-color-primary btn-sm px-4",children:s.jsx("i",{className:"bi bi-pencil-fill fs-6"})}),s.jsx("button",{onClick:()=>o(),className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm",children:l?s.jsx(Y,{size:12}):s.jsx("i",{className:"bi bi-arrow-clockwise"})})]})})]},a._id),s.jsx(M,{severity:e.color,message:e.message,open:e.openAlert,close:t})]})};export{S as default};
