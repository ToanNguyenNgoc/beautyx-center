import{a7 as N,V as _,z as b,s as w,aD as i,bV as t,v as r,j as e,a8 as D,au as C,bY as Y}from"./index-CwORS_Xz.js";import{u as y,A as M}from"./index-D_k0cNNM.js";import{d as k}from"./discounts-hb3ODqxG.js";import{L as q}from"./LoadingButton-Yjdjcb8X.js";const L=()=>{const c=N(),{resultLoad:o,onCloseNoti:m,noti:l}=y(),{mutate:d,isLoading:u}=_({mutationFn:s=>k.postDiscount(s),onSuccess:()=>{o({message:"Tạo thành công",color:"success"}),setTimeout(()=>c(-1),2e3)},onError:()=>{o({message:"Có lỗi xảy ra",color:"error"})}}),a=b({initialValues:{title:"",coupon_code:"",description:"",discount_value:"",total:"",valid_from:i().format("YYYY-MM-DD HH:mm:ss"),valid_util:i().format("YYYY-MM-DD HH:mm:ss"),limit:""},validationSchema:w({title:r().required("Vui lòng nhập tên chương trình khuyến mại"),coupon_code:r().required("Vui lòng nhập Mã giảm giá"),description:r().required("Vui lòng nhập mô tả chương trình khuyến mại"),discount_value:t().min(1e3,"Giá trị giảm lớn hơn 1000").required("Vui lòng nhập giá trị giảm"),total:t().min(0,"Số lượng mã tối đa 4000 mã").max(4e3,"Số lượng mã tối đa 4000 mã").required("Vui lòng nhập số lượng mã"),limit:t().min(1,"Lượt sử dụng mỗi khách lớn hơn 1")}),onSubmit:s=>{const{title:h,coupon_code:p,description:g,discount_value:n,total:x,valid_from:v,valid_util:f,limit:j}=s;d({title:h,coupon_code:p,description:g,platform:"BEAUTYX",discount_type:"SUB_TOTAL",discount_unit:"PRICE",is_campaign:1,valid_from:v,valid_util:f,discount_value:n,total:Number(x),minimum_order_value:Number(n),limit:Number(j)})}});return e.jsxs(e.Fragment,{children:[e.jsx(M,{severity:l.color,message:l.message,open:l.openAlert,close:m}),e.jsx(D,{title:"Tạo mới voucher"}),e.jsx("div",{className:"post d-flex flex-column-fluid",id:"kt_post",children:e.jsx("div",{className:"container",children:e.jsxs("form",{autoComplete:"off",className:"form",onSubmit:a.handleSubmit,children:[e.jsx("div",{className:"flex-row-sp align-items-center input-wrap",children:e.jsx("div",{className:"wrap-item",children:e.jsx(C,{value:!0,label:"Is campaign (Áp dụng mã giảm giá BeautyX)"})})}),e.jsxs("div",{className:"flex-row-sp input-wrap",children:[e.jsxs("div",{className:"wrap-item",children:[e.jsx("label",{className:"required form-label",children:"Mã giảm giá"}),e.jsx("input",{onChange:a.handleChange,value:a.values.coupon_code,name:"coupon_code",type:"text",className:"form-control form-control-solid",placeholder:`BTX${i().format("DDMM")}`}),a.errors.coupon_code&&a.touched.coupon_code&&e.jsx("span",{className:"text-danger",children:a.errors.coupon_code})]}),e.jsxs("div",{className:"wrap-item",children:[e.jsx("label",{className:"required form-label",children:"Tên"}),e.jsx("input",{onChange:a.handleChange,value:a.values.title,name:"title",type:"text",className:"form-control form-control-solid",placeholder:"Chương trình khuyến mại"}),a.errors.title&&a.touched.title&&e.jsx("span",{className:"text-danger",children:a.errors.title})]})]}),e.jsxs("div",{className:"input-wrap",children:[e.jsx("label",{className:"required form-label",children:"Mô tả"}),e.jsx("input",{onChange:a.handleChange,value:a.values.description,name:"description",type:"text",className:"form-control form-control-solid",placeholder:"Mô tả chương trình khuyến mại"}),a.errors.description&&a.touched.description&&e.jsx("span",{className:"text-danger",children:a.errors.description})]}),e.jsx("div",{className:"flex-row-sp input-wrap",children:e.jsxs("div",{className:"wrap-item wrap-item-col-4",children:[e.jsx("label",{className:"required form-label",children:"Giá trị giảm giá"}),e.jsx("input",{onChange:a.handleChange,value:a.values.discount_value,name:"discount_value",type:"number",className:"form-control form-control-solid",placeholder:"Giá trị giảm giá"}),a.errors.discount_value&&a.touched.discount_value&&e.jsx("span",{className:"text-danger",children:a.errors.discount_value})]})}),e.jsxs("div",{className:"flex-row-sp input-wrap",children:[e.jsxs("div",{className:"wrap-item wrap-item-col-4",children:[e.jsx("label",{className:"required form-label",children:"Số lượng"}),e.jsx("input",{value:a.values.total,onChange:a.handleChange,name:"total",type:"number",className:"form-control form-control-solid",placeholder:""}),a.errors.total&&a.touched.total&&e.jsx("span",{className:"text-danger",children:a.errors.total})]}),e.jsxs("div",{className:"wrap-item wrap-item-col-4",children:[e.jsx("label",{className:"required form-label",children:"Lượt sử dụng mỗi khách"}),e.jsx("input",{value:a.values.limit,onChange:a.handleChange,name:"limit",type:"number",className:"form-control form-control-solid",placeholder:""}),a.errors.limit&&a.touched.limit&&e.jsx("span",{className:"text-danger",children:a.errors.limit})]}),e.jsx("div",{className:"wrap-item wrap-item-col-4",children:e.jsx(Y,{minDate:new Date,startDate:new Date(a.values.valid_from),endDate:new Date(a.values.valid_util),onChange:s=>{a.setFieldValue("valid_from",i(s.selection.startDate).format("YYYY-MM-DD HH:mm:ss")),a.setFieldValue("valid_util",i(s.selection.endDate).format("YYYY-MM-DD HH:mm:ss"))}})})]}),e.jsx("div",{className:"input-form__bot",children:e.jsx(q,{type:"submit",variant:"contained",size:"large",color:"success",loading:u,children:"Lưu thay đổi"})})]})})})]})};export{L as default};
