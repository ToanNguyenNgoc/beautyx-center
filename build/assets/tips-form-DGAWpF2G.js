import{U as f,a as v,a8 as N,V as p,z as T,s as E,bR as D,v as h,j as e,at as I,aE as o,ae as C,Q as A,as as P,a9 as w}from"./index-CPKrhu4T.js";import{t as c}from"./tipApi-DX8BpkJV.js";function F(n){const r=f(),{isForm:i,tip:a,tipId:x}=n,[y,g]=v.useState(!!(a!=null&&a.status)),l=N(),{mutate:b,isLoading:m}=p({mutationFn:t=>c.updateTip(x,t),onSuccess:()=>{r.invalidateQueries([o.TIP_PAGE]),l(-1)},onError:t=>{console.log(t)}}),{mutate:j,isLoading:u}=p({mutationFn:t=>c.postTip(t),onSuccess:()=>{r.invalidateQueries([o.TIP_PAGE]),l(-1)},onError:t=>{console.log(t)}}),s=T({initialValues:{name:i==="EDIT"?a==null?void 0:a.name:"",type:i==="EDIT"?a==null?void 0:a.type:"",priority:i==="EDIT"?a==null?void 0:a.priority:0,status:i==="EDIT"?y:1},validationSchema:E({name:h().trim().required("Vui lòng nhập nội dung"),type:h().trim().required("Vui lòng nhập loại"),priority:D().required("Vui lòng nhập độ ưu tiên").min(0,"Độ ưu tiên thấp nhất là 0")}),onSubmit:t=>{const d={...t,status:t.status?1:0};i==="ADD"?j(d):b(d)}});return e.jsx(e.Fragment,{children:e.jsx("form",{className:"discount-form mb-10 container",onSubmit:s.handleSubmit,autoComplete:"off",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"wrap-item col-12",children:[e.jsx("label",{className:"form-label",children:"Nội dung"}),e.jsx("textarea",{onChange:s.handleChange,value:s.values.name,className:"form-control",placeholder:"Aa",rows:4,cols:50,name:"name"}),s.errors.name&&s.touched.name&&e.jsx("span",{className:"text-danger d-block mt-2",children:s.errors.name})]}),e.jsxs("div",{className:"row mt-10",children:[e.jsxs("div",{className:"wrap-item col-4",children:[e.jsx("label",{className:"form-label",children:"Loại"}),e.jsx("input",{disabled:i==="EDIT",onChange:s.handleChange,value:s.values.type,type:"text",className:"form-control",placeholder:"Aa",name:"type"}),s.errors.type&&s.touched.type&&e.jsx("span",{className:"text-danger d-block mt-2",children:s.errors.type})]}),e.jsxs("div",{className:"wrap-item col-4",children:[e.jsx("label",{className:"form-label",children:"Độ ưu tiên"}),e.jsx("input",{onChange:s.handleChange,value:s.values.priority,type:"number",className:"form-control",placeholder:"Aa",name:"priority"}),s.errors.priority&&s.touched.priority&&e.jsx("span",{className:"text-danger d-block mt-2",children:s.errors.priority})]}),e.jsxs("div",{className:"wrap-item col-4",children:[e.jsx("label",{className:"form-label",children:"Trạng thái"}),e.jsx("div",{children:e.jsx(I,{value:s.values.status,onChange:t=>g(t.target.checked),label:"Kích hoạt để hiển thị tip"})})]})]}),e.jsxs("div",{className:"d-flex flex-end gap-4 mt-10",children:[e.jsx("button",{onClick:()=>l(-1),type:"button",className:"btn btn-primary",children:"Quay lại"}),e.jsx("button",{disabled:!!(m||u),className:"btn btn-success",children:m||u?"Loading...":"Lưu thay đổi"})]})]})})})}function Q(){const n=C();let r="ADD";n&&n.id&&(r="EDIT");const{data:i}=A({queryKey:[o.TIP_PAGE,n.id],queryFn:()=>c.getById(parseInt(n.id))}),a=i==null?void 0:i.context;return e.jsxs(P,{permissions:r==="ADD"?["v1.beautyx.tips.store"]:["v1.beautyx.tips.update"],showEmpty:!0,children:[e.jsx(w,{title:n!=null&&n.id?"Chỉnh sửa thông tin Tip":"Tạo mới Tip"}),(r==="ADD"||a)&&e.jsx(F,{tipId:parseInt(n.id),tip:a,isForm:r})]})}export{Q as default};
