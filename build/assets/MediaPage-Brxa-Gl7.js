import{Q as j,j as e,a8 as u,at as o,L as g,am as f,a9 as b,a7 as N,a as v,au as y,av as h,K as p,aw as w,ax as r,ay as k}from"./index-BuiS39ZH.js";import{u as _}from"./useQueryParams-BuaNsegx.js";import{T as x}from"./trendApi-DF3XcaFe.js";import"./axios.instance-Dl_stjmW.js";const S=()=>{var t;const{query:s,handleQueryString:c}=_(),{data:a,refetch:d,isLoading:l}=j({queryKey:[k.Trend,s],queryFn:()=>x.get({page:(s==null?void 0:s.page)??1,limit:15,append:"media_url|media_thumbnail_url",include:"organization","filter[status]":s["filter[status]"],"filter[organization_id]":s["filter[organization_id]"],sort:s.sort??"-created_at"})}),m=(a==null?void 0:a.context.data)||[],n=i=>w.open({callBack:()=>x.delete(i).then(()=>{r.open({title:"Xóa thành công"}),d()}).catch(()=>r.open({title:"Có lỗi xảy ra. Vui lòng thử lại",type:"error"}))});return e.jsxs("div",{children:[e.jsx(u,{element:e.jsx(o,{permissions:["v1.trends.store"],children:e.jsx(g,{to:{pathname:"/pages/medias-form"},className:"btn btn-sm btn-primary",children:"Tạo mới"})}),title:"Danh sách"}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header border-0 pt-5",children:e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Trends"}),e.jsxs("span",{className:"text-muted mt-1 fw-semobold fs-7",children:["Over ",((t=a==null?void 0:a.context)==null?void 0:t.total)||0]})]})}),e.jsx("div",{className:"card-body py-3",children:e.jsxs("div",{className:"table-responsive",children:[e.jsxs("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"fw-bold text-muted",children:[e.jsx("th",{className:"min-w-50px",children:"Độ ưu tiên"}),e.jsx("th",{className:"min-w-150px",children:"Thumbnail & Tiêu đề"}),e.jsx("th",{className:"min-w-140px",children:"Doanh nghiệp"}),e.jsx("th",{className:"min-w-120px",children:"Trạng thái"}),e.jsx("th",{className:"min-w-120px",children:"Ngày tạo"}),e.jsx("th",{className:"min-w-120px",children:"Ngày cập nhật"}),e.jsx("th",{className:"min-w-100px text-end",children:"Actions"})]})}),e.jsx("tbody",{children:m.map(i=>e.jsx(P,{trend:i,onDelete:()=>n(i.id)},i.id))})]}),e.jsx(f,{loading:l}),e.jsx(b,{totalPage:(a==null?void 0:a.context.last_page)??1,onChangePage:i=>c("page",i),defaultPage:s.page})]})})]})]})},P=({trend:s,onDelete:c})=>{var n;const a=N(),[d,l]=v.useState(s.status),m=t=>{l(t),x.update(s.id,{status:t}).then(()=>r.open({title:"Lưu thành công",type:"success"})).catch(()=>{r.open({title:"Có lỗi xảy ra. Vui lòng thử lại",type:"error"}),l(s.status)})};return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"d-flex align-items-center",children:e.jsx("div",{className:"d-flex justify-content-start flex-column",children:e.jsx("span",{className:"text-dark fw-bold text-hover-primary fs-6",children:s.priority})})})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"symbol symbol-100px me-5",children:e.jsx("img",{src:s.media_thumbnail_url,alt:""})}),e.jsx("div",{className:"d-flex justify-content-start flex-column",children:e.jsx("span",{className:"text-dark fw-bold text-hover-primary fs-6",children:s.title})})]})}),e.jsx("td",{children:e.jsx("span",{className:"text-dark fw-bold text-hover-primary d-block fs-6",children:(n=s.organization)==null?void 0:n.name})}),e.jsx("td",{className:"text-start",children:e.jsx(y,{value:d,label:"",onChange:t=>m(t.target.checked)})}),e.jsx("td",{className:"text-end",children:e.jsx("div",{className:"d-flex flex-column w-100 me-2",children:e.jsx("div",{className:"d-flex flex-stack mb-2",children:e.jsx("span",{className:"text-muted me-2 fs-7 fw-semobold",children:h(s.created_at,"DD/MM/YYYY HH:mm")})})})}),e.jsx("td",{className:"text-end",children:e.jsx("div",{className:"d-flex flex-column w-100 me-2",children:e.jsx("div",{className:"d-flex flex-stack mb-2",children:e.jsx("span",{className:"text-muted me-2 fs-7 fw-semobold",children:h(s.updated_at,"DD/MM/YYYY HH:mm")})})})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex justify-content-end flex-shrink-0",children:[e.jsx(o,{permissions:["v1.trends.update"],children:e.jsx("button",{onClick:()=>a(`/pages/medias-form/${s.id}`),"aria-label":"Xem chi tiết",className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",children:e.jsx(p,{path:"/media/icons/duotune/art/art005.svg",className:"svg-icon-3"})})}),e.jsx(o,{permissions:["v1.trends.destroy"],children:e.jsx("button",{"aria-label":"Xóa",className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1",onClick:c,children:e.jsx(p,{path:"/media/icons/duotune/general/gen027.svg",className:"svg-icon-3"})})})]})})]})};export{S as default};
