import{a as l,W as x,bQ as b,j as r,bR as w,bS as E,bT as y,b4 as T}from"./index-BHl1vF-Z.js";import{d as _}from"./discounts-CUePuapv.js";import{L as S}from"./LoadingButton-BU6aPnkN.js";const k=({discount:o,title:m=" Xuất mã giảm giá",size:u="medium"})=>{const[a,d]=l.useState(1),n=30,[s,i]=l.useState([]),{mutate:p,data:e,isLoading:g}=x({mutationKey:["GET_CODE",o.uuid],mutationFn:t=>_.getCodeIsCampaign({uuid:o.uuid,page:t.page,limit:n}),onSuccess(t){const f=t.data;i(h=>h=[...h,...f]),d(Math.ceil(t.total/n))}}),c=()=>{i([]),d(1),p({page:1})};return l.useEffect(()=>{if(a>1)for(let t=2;t<=a;t++)p({page:t})},[a]),l.useEffect(()=>{s.length===(e==null?void 0:e.total)&&C({file_name:b(o.title),codes:s})},[s,e==null?void 0:e.total]),r.jsx(r.Fragment,{children:r.jsxs(S,{color:"success",size:u,variant:"contained",onClick:c,type:"button",loading:g,children:[r.jsx("i",{style:{marginRight:"4px",color:"var(--kt-white)"},className:"bi bi-download"}),m]})})},C=({file_name:o,codes:m})=>{const u="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",a=".xlsx",n=[["STT","Danh sách mã","Trạng thái sử dụng"],...m.map((c,t)=>[t+1,c.coupon_code,c.status==="1"?"Chưa sử dụng":"Đã sử dụng"])],s=w.aoa_to_sheet(n),i=[{wch:8},{wch:35},{wch:25}];s["!cols"]=i;const e=E({Sheets:{data:s},SheetNames:["data"]},{bookType:"xlsx",type:"array"}),g=new Blob([e],{type:u});y.saveAs(g,`Ma_giam_gia_${o}_${T().format("DDHHmmss")}`+a)};export{k as E};
