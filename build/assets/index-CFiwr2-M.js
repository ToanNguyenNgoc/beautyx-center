import{j as e,X as N,a as p,Y as f,Z as w,_ as A,a0 as z,a1 as R,a2 as m,a3 as H,a4 as S,a5 as g,a6 as M,e as O,a7 as V,a8 as L,K as U,a9 as I,aa as X}from"./index-CJshWYnI.js";import{u as F,a as G}from"./approveApi-DcsY-Z2u.js";import{X as K}from"./index-CbR66IRN.js";import"./LoadingButton-7NcAxfBL.js";const B="_container_rj767_1",$={container:B};function J(t){const l=n=>t.onChange&&t.onChange(n);return e.jsx("textarea",{className:$.container,onChange:l,placeholder:t.placeholder??""})}const Z="_container_1k5k7_1",Q="_header_1k5k7_8",W="_header_title_1k5k7_17",q="_header_created_1k5k7_18",ee="_body_1k5k7_28",se="_body_head_cnt_1k5k7_33",ae="_body_org_1k5k7_40",te="_body_org_img_1k5k7_50",oe="_body_org_detail_1k5k7_66",ne="_org_name_1k5k7_70",le="_org_address_1k5k7_76",re="_org_contact_1k5k7_81",ce="_org_contact_title_1k5k7_84",ie="_body_approve_detail_1k5k7_91",de="_body_approve_section_1k5k7_99",_e="_body_approve_title_1k5k7_110",pe="_body_approve_btn_1k5k7_116",me="_approve_list_1k5k7_125",he="_approve_list_show_1k5k7_140",ge="_approve_list_item_1k5k7_147",xe="_body_log_cnt_1k5k7_166",be="_body_log_left_1k5k7_174",je="_body_log_right_1k5k7_175",ve="_approve_logs_1k5k7_191",ue="_approve_logs_item_1k5k7_197",ye="_log_item_1k5k7_206",ke="_log_item_date_1k5k7_214",Ne="_approve_bot_1k5k7_220",s={container:Z,header:Q,header_title:W,header_created:q,body:ee,body_head_cnt:se,body_org:ae,body_org_img:te,body_org_detail:oe,org_name:ne,org_address:le,org_contact:re,org_contact_title:ce,body_approve_detail:ie,body_approve_section:de,body_approve_title:_e,body_approve_btn:pe,approve_list:me,approve_list_show:he,approve_list_item:ge,body_log_cnt:xe,body_log_left:be,body_log_right:je,approve_logs:ve,approve_logs_item:ue,log_item:ye,log_item_date:ke,approve_bot:Ne};function fe(t){var u,y;const{open:l,setOpen:n,approve:o}=t,i=N(),[c,d]=p.useState({log:"",status:o.status}),{noti:r,firstLoad:h,resultLoad:x,onCloseNoti:T}=F(),[C,b]=p.useState(!1);f(C&&l,A.APPROVES,{...w,page:(i==null?void 0:i.page)??1});const Y=async()=>{h();try{await G.putApprove(o.id,c),b(!0),x("Đã lưu thay đổi")}catch{x("Có lỗi xảy ra")}},P=()=>{b(!1),n(!1)},j=p.useRef(null),v=()=>{var a,k;(k=(a=j.current)==null?void 0:a.classList)==null||k.toggle(s.approve_list_show)},D=a=>d({...c,status:a}),E=a=>{d({...c,log:a.target.value})};let _=!1;return(o.status==="APPROVED"||o.status==="REJECT")&&(_=!0),e.jsx(e.Fragment,{children:e.jsxs(z,{open:l,onClose:P,children:[e.jsx(R,{title:r.message,open:r.openAlert,onClose:T}),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.header,children:[e.jsx("span",{className:s.header_title,children:"Chi tiết kiểm duyệt"}),e.jsxs("span",{className:s.header_created,children:["Ngày tạo:",m(o.created_at).format("HH:mm DD/MM/YYYY")]})]}),o.organization&&e.jsx("div",{className:s.body,children:e.jsxs("div",{className:s.body_head_cnt,children:[e.jsxs("div",{className:s.body_org,children:[e.jsx("div",{className:s.body_org_img,children:e.jsx("img",{onError:a=>H(a),src:o.organization.image_url,alt:""})}),e.jsxs("div",{className:s.body_org_detail,children:[e.jsx("p",{title:"Xem gian hàng",className:s.org_name,children:o.organization.name}),e.jsx("p",{className:s.org_address,children:o.organization.full_address}),e.jsxs("div",{className:s.org_contact,children:[e.jsx("p",{className:s.org_contact_title,children:"Thông tin liên lạc"}),e.jsx("div",{className:s.org_contact_list,children:(u=o.organization.telephone)==null?void 0:u.map(a=>e.jsx("p",{className:s.org_contact_item,children:a},a))})]})]})]}),e.jsxs("div",{className:s.body_approve_detail,children:[e.jsxs("div",{className:s.body_approve_section,children:[e.jsx("p",{className:s.body_approve_title,children:"Kiểm duyệt cho"}),e.jsx(S,{type:o.type})]}),e.jsxs("div",{className:s.body_approve_section,children:[e.jsx("p",{className:s.body_approve_title,children:"Trạng thái"}),e.jsx(g,{status:c.status}),e.jsxs("button",{style:_?{cursor:"not-allowed"}:{},disabled:_,onFocus:v,onBlur:v,className:s.body_approve_btn,children:[e.jsx("i",{className:"bi bi-pencil-fill fs-5"}),e.jsx("ul",{ref:j,className:s.approve_list,children:M.map(a=>e.jsx("li",{onClick:()=>D(a.STATUS),className:s.approve_list_item,children:e.jsx(g,{status:a.STATUS})},a.STATUS))})]})]})]})]})}),e.jsxs("div",{className:s.body_log_cnt,children:[e.jsxs("div",{className:s.body_log_left,children:[e.jsx("span",{className:s.body_approve_title,children:"Ghi chú"}),e.jsx("ul",{className:s.approve_logs,children:(y=o.logs)==null?void 0:y.map(a=>e.jsxs("li",{className:s.approve_logs_item,children:[e.jsx("div",{className:s.log_item,children:a.note}),e.jsx("span",{className:s.log_item_date,children:m(a.created_at).format("HH:mm DD/MM/YYYY")})]},a.id))})]}),e.jsxs("div",{className:s.body_log_right,children:[e.jsx("span",{className:s.body_approve_title,children:"Viết ghi chú"}),e.jsx(J,{onChange:E,placeholder:"Viết ghi chú..."})]})]}),e.jsx("div",{className:s.approve_bot,children:e.jsx(K,{onClick:Y,title:"Lưu thay đổi",color:"success",loading:r.load,disable:_})})]})]})})}function Ye(){const t=O(),l=V(),n=N(),{responseArray:o,totalItem:i,totalPage:c}=f(!0,A.APPROVES,{...w,page:(n==null?void 0:n.page)??1}),d=r=>{l({pathname:t.pathname,search:`page=${r}`})};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Kiểm duyệt"}),e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsxs("h3",{className:"card-title align-items-start flex-column",children:[e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Danh sách kiểm duyệt"}),e.jsxs("span",{className:"text-muted mt-1 fw-semobold fs-7",children:[i," kiểm duyệt"]})]}),e.jsx("div",{className:"card-toolbar",children:e.jsx("button",{type:"button",className:"btn btn-sm btn-icon btn-color-primary btn-active-light-primary","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end","data-kt-menu-flip":"top-end",children:e.jsx(U,{path:"/media/icons/duotune/general/gen024.svg",className:"svg-icon-2"})})})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle gs-0 gy-4",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"fw-bold text-muted bg-light",children:[e.jsx("th",{className:"ps-4 min-w-250px rounded-start",children:"Doanh nghiệp"}),e.jsx("th",{className:"min-w-110px",children:"Duyệt cho"}),e.jsx("th",{className:"min-w-110px",children:" Trạng thái "}),e.jsx("th",{className:"min-w-150px",children:"Ghi chú"}),e.jsx("th",{className:"min-w-140px",children:"Ngày tạo"}),e.jsx("th",{className:"min-w-140px",children:"Cập nhật lúc"}),e.jsx("th",{className:"min-w-100px text-end rounded-end"})]})}),e.jsx("tbody",{children:o==null?void 0:o.map((r,h)=>e.jsx(we,{item:r},h))})]})})})]}),e.jsx(I,{totalPage:c,onChangePage:d,defaultPage:(n==null?void 0:n.page)??1})]})}const we=({item:t})=>{var o;const[l,n]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(fe,{open:l,setOpen:n,approve:t}),e.jsxs("tr",{children:[t.organization&&e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"symbol symbol-50px me-5",children:e.jsx(X,{src:t.organization.image_url})}),e.jsxs("div",{className:"d-flex justify-content-start flex-column",children:[e.jsx("span",{className:"text-dark fw-bold text-hover-primary mb-1 fs-6",children:t.organization.name}),e.jsx("span",{className:"text-muted fw-semobold text-muted d-block fs-7",children:t.organization.address})]})]})}),e.jsx("td",{children:e.jsx(S,{type:t.type})}),e.jsx("td",{children:e.jsx(g,{status:t.status})}),e.jsx("td",{children:t.logs.length>0&&e.jsx("span",{className:"text-muted fw-semobold text-muted d-block fs-7 mt-1",children:(o=t.logs[0])==null?void 0:o.note})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted fw-semobold text-muted d-block fs-7 mt-1",children:m(t.created_at).format("HH:mm - DD/MM/YYYY")})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted fw-semobold text-muted d-block fs-7 mt-1",children:m(t.updated_at).format("HH:mm - DD/MM/YYYY")})}),e.jsx("td",{className:"text-end",children:e.jsx("button",{onClick:()=>n(!0),className:"btn btn-bg-light btn-color-muted btn-active-color-primary btn-sm px-4",children:e.jsx("i",{className:"bi bi-pencil-fill fs-6"})})})]})]})};export{Ye as default};
