import{Q as b,a7 as y,aE as w,aF as k,j as e,as as _,a9 as A,an as P,L as M,aD as u,aa as T,aA as N,ck as g,aB as v,aC as n,aI as Y}from"./index-B-8ZwVwN.js";import{u as C}from"./useDebounce-DXNKKYu3.js";import{u as F}from"./useQueryParams-J0XWvKRZ.js";import{F as E}from"./index-CYPFytSd.js";import{A as D}from"./Avatar-Kn6OQjuO.js";function I(s,r){var c,t;const a=b({queryKey:[w.Comments,s],queryFn:()=>y.Appointment.get(s),retry:!1,...r}),i=((t=(c=a.data)==null?void 0:c.context)==null?void 0:t.data)||[];return{...a,appointments:i}}const G=()=>{var d;const{query:s,handleQueryString:r}=F(),a=C(s["filter[keyword]"]||"",800),{appointments:i,isLoading:c,data:t}=I({append:"services",include:"organization|user|order|branch",sort:(s==null?void 0:s.sort)||"-created_at","filter[platform]":(s==null?void 0:s["filter[platform]"])??"MOMO|BEAUTYX|BEAUTYX-MOBILE|GMUP",hidden_qr_link:!0,"filter[keyword]":a,...k.omit(s,["filter[keyword]"])});return e.jsxs(_,{permissions:["v1.admin.appointments.index"],showEmpty:!0,children:[e.jsx(A,{title:"Danh sách lịch hẹn",element:e.jsx("div",{className:"order-title flex-row align-items-center justify-content-end",children:e.jsx("span",{style:{whiteSpace:"nowrap"},className:"text-gray-400 fw-bold fs-7 gs-0",children:"Bộ lọc:"})})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-8",children:[e.jsx(L,{query:s,handleQueryString:r}),e.jsx("div",{className:"filter-list"})]}),e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:`Tổng đơn hàng (${((d=t==null?void 0:t.context)==null?void 0:d.total)||0})`})}),e.jsx("div",{})]}),e.jsxs("div",{className:"card-body py-3",children:[e.jsx("div",{className:"table-responsive",children:c?e.jsx("div",{className:"d-flex justify-content-center py-3",children:e.jsx(P,{size:"30px",style:{color:"var(--beautyx)"}})}):e.jsxs("table",{className:"table table-row-bordered table-row-gray-100 align-middle gs-0 gy-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"fw-bold text-muted",children:[e.jsx("th",{className:"min-w-80px",children:"Appointment Id"}),e.jsx("th",{className:"min-w-140px",children:"Tên KH"}),e.jsx("th",{className:"min-w-120px",children:"Cửa hàng"}),e.jsx("th",{className:"min-w-120px",children:"Nền tảng"}),e.jsx("th",{className:"min-w-120px",children:"Thời gian lịch hẹn"}),e.jsx("th",{className:"min-w-100px",children:"Ghi chú"}),e.jsx("th",{className:"min-w-120px",children:"Ngày tạo"}),e.jsx("th",{className:"min-w-40px text-end",children:"Actions"})]})}),e.jsx("tbody",{children:i==null?void 0:i.map(l=>{var o,m,h,x,j,p,f;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(M,{to:"#",className:"text-dark fw-bold  fs-6",children:l==null?void 0:l.id})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"symbol symbol-45px me-5",children:e.jsx(D,{src:((o=l.user)==null?void 0:o.avatar)||((m=l.user)==null?void 0:m.fullname),alt:(h=l.user)==null?void 0:h.fullname})}),e.jsxs("div",{className:"d-flex justify-content-start flex-column",children:[e.jsx("span",{className:"text-dark fw-bold fs-6",children:(x=l.user)==null?void 0:x.fullname}),e.jsx("span",{className:"fw-semobold text-muted d-block fs-6",children:(j=l.user)==null?void 0:j.telephone}),e.jsx("span",{className:"fw-semobold text-muted d-block fs-7",children:(p=l.user)==null?void 0:p.email})]})]})}),e.jsx("td",{children:(f=l.organization)==null?void 0:f.name}),e.jsx("td",{children:e.jsx(E,{platForm:l.platform})}),e.jsx("td",{children:u(l.time_start).format("YYYY-MM-DD HH.mm")}),e.jsx("td",{children:l.note}),e.jsx("td",{children:u(l.created_at).format("YYYY-MM-DD HH.mm")})]},l.id)})})]})}),e.jsx("div",{className:"mt-5",children:e.jsx(T,{totalPage:(t==null?void 0:t.context.last_page)||1,onChangePage:l=>r("page",l),defaultPage:s.page})})]})]})]})},L=({query:s,handleQueryString:r})=>e.jsxs("div",{children:[e.jsx("div",{className:"filter-list pb-6",children:e.jsx("div",{className:"filter-item",children:e.jsx("input",{defaultValue:s["filter[keyword]"]||"",value:s["filter[keyword]"],onChange:a=>r("filter[keyword]",a.target.value),className:"form-control form-control-solid",placeholder:"Tìm kiếm Tên, email, phone..."})})}),e.jsxs("div",{className:"filter-list",children:[e.jsx("div",{className:"filter-item",children:e.jsxs(N,{style:{width:"100%"},size:"small",children:[e.jsx(g,{id:"demo-select-small-label",children:"Xắp xếp theo"}),e.jsxs(v,{labelId:"demo-select-small-label",id:"demo-select-small",label:"Mới nhất",value:s.sort||"-created_at",onChange:a=>r("sort",a.target.value),children:[e.jsx(n,{value:"-created_at",children:"Ngày tạo mới nhất"}),e.jsx(n,{value:"created_at",children:"Ngày tạo cũ nhất"}),e.jsx(n,{value:"-time_start",children:"Ngày đặt lịch mới nhất"}),e.jsx(n,{value:"time_start",children:"Ngày đặt lịch cũ nhất"})]})]})}),e.jsx("div",{className:"filter-item",children:e.jsxs(N,{style:{width:"100%"},size:"small",children:[e.jsx(g,{id:"platform-select-label",children:"Platform"}),e.jsxs(v,{labelId:"platform-select-label",id:"platform-select",label:"Tất cả",value:s["filter[platform]"]||"",onChange:a=>r("filter[platform]",a.target.value),children:[e.jsx(n,{value:"",children:"Tất cả"}),Object.values(Y).map(a=>e.jsx(n,{value:a,children:a},a))]})]})})]})]});export{G as default};
