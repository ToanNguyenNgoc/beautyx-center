import{a as h,W as k,ah as C,j as r,bI as S,ao as z,bz as F}from"./index-BHl1vF-Z.js";import{d as _}from"./discounts-CUePuapv.js";import{F as I}from"./index-BS_oHEVL.js";import{C as A}from"./Chip-DrXhVjId.js";import{A as g}from"./Avatar-Ckuqs-6L.js";const G=({label:f="Gắn deal giảm giá",required:u=!1,discounts:a=[],onChangeDiscounts:i,filterAll:x=!0,platform:p=""})=>{var d;const t=h.useRef(null),n=e=>{t.current&&(e==="hide"&&t.current.classList.remove("org-search-show"),e==="show"&&t.current.classList.add("org-search-show"))};window.addEventListener("click",()=>n("hide"));const{mutate:j,isLoading:v,data:o}=k({mutationFn:e=>_.getAll({"filter[keyword]":e,sort:"-created_at","filter[filter_all]":x,"filter[platform]":p})}),b=h.useCallback(C.debounce(e=>j(e),600),[]),N=e=>b(e.target.value),c=e=>{i&&(a.findIndex(s=>s.id===e.id)<0?i([...a,e]):i(a.filter(s=>s.id!==e.id)))};return r.jsxs("div",{className:"col col-org",children:[r.jsxs("label",{className:`${u?"required":""} form-label`,children:[f," (",a.length," deal giảm giá)"]}),r.jsx("div",{onClick:e=>{e.stopPropagation(),n("show")},className:"form-control form-control-solid",children:a.length>0?a.map(e=>{var l,s;return r.jsx(A,{variant:"filled",className:"m-1",color:"success",label:e.title+" ["+e.platform+"]",avatar:r.jsx(g,{alt:e.title,src:e.items.length>0?(s=(l=e.items[0])==null?void 0:l.productable)==null?void 0:s.image_url:e.title}),onDelete:()=>c(e)},e.id)}):"Gắn dịch vụ"}),r.jsx(S,{ref:t,sx:{boxShadow:3},className:"org-search",children:r.jsxs("div",{onClick:e=>e.stopPropagation(),children:[r.jsx("input",{autoFocus:!0,onChange:N,type:"text",className:"form-control form-control-solid",placeholder:"Tìm kiếm deal..."}),v&&r.jsx(z,{size:16}),r.jsx("div",{className:"org-list",children:r.jsx("ul",{className:"list",children:(d=o==null?void 0:o.data)==null?void 0:d.map(e=>{var s,m;let l=e.title;return e.items.length>0?l=(s=e.items[0].productable)==null?void 0:s.image_url:e.organizations.length>0&&(l=e.organizations[0].image_url),r.jsxs(F,{selected:a.map(w=>w.id).includes(e.id),onClick:()=>c(e),children:[r.jsx(g,{alt:e.title,src:l}),r.jsxs("div",{className:"column item-content",children:[r.jsxs("div",{className:"title",children:[e.title,r.jsx(I,{platForm:e.platform})]}),r.jsx("div",{children:e.organizations.length>0&&r.jsx("span",{children:(m=e.organizations[0])==null?void 0:m.name})})]})]},e.id)})})})]})})]})};export{G as S};
